Test Set Evaluation Results
==================================================
Total test queries executed: 0
Successful test queries: 0
None count: 0
None IDs: 
Empty count: 0
Empty IDs: 
==================================================

--- Processing Test Case 26 ---
Natural Language Query: What does the Guide to Pharmacology know about Voltage-gated ion channels?
Expected SQL: select o.object_id, o.name as name, string_agg(f.name, ' | ') as family from object o left join receptor2family rf on o.object_id=rf.object_id left join family f on rf.family_id=f.family_id where o.object_id in (select object_id from receptor2family where family_id in (WITH RECURSIVE subfamilies AS ( SELECT group_id, family_id from grouping where group_id in (select family_id from family where name ilike '%Voltage-gated ion channels%') UNION SELECT e.group_id, e.family_id from grouping e INNER JOIN subfamilies s ON s.family_id=e.group_id) SELECT family_id FROM subfamilies order by family_id)) group by o.object_id, f.family_id;
Generated SQL: -- Retrieve information about voltage-gated ion channels, their interactions, and related ligands
SELECT 
    o.object_id, 
    o.name AS channel_name,
    i.interaction_id,
    l.ligand_id,
    l.name AS ligand_name,
    i.type AS interaction_type,
    i.affinity_units,
    CASE 
        WHEN i.affinity_median IS NULL THEN 
            CASE 
                WHEN i.affinity_high IS NULL THEN i.affinity_low 
                ELSE i.affinity_high 
            END 
        ELSE i.affinity_median 
    END AS affinity
FROM 
    object o
JOIN 
    interaction i ON o.object_id = i.object_id
JOIN 
    ligand l ON i.ligand_id = l.ligand_id
WHERE 
    o.object_id IN (
        SELECT object_id 
        FROM receptor2family 
        WHERE family_id IN (
            WITH RECURSIVE subfamilies AS (
                SELECT group_id, family_id 
                FROM grouping 
                WHERE group_id IN (
                    SELECT family_id 
                    FROM family 
                    WHERE name ILIKE '%Voltage-gated ion channels%'
                )
                UNION
                SELECT e.group_id, e.family_id 
                FROM grouping e 
                INNER JOIN subfamilies s ON s.family_id = e.group_id
            )
            SELECT family_id 
            FROM subfamilies 
            UNION 
            SELECT family_id 
            FROM family 
            WHERE name ILIKE '%Voltage-gated ion channels%'
        )
    );

Expected SQL Results:
     object_id               name                                             family
0          380  K<sub>Ca</sub>1.1  Calcium- and sodium-activated potassium channe...
1          381  K<sub>Ca</sub>2.1  Calcium- and sodium-activated potassium channe...
2          382  K<sub>Ca</sub>2.2  Calcium- and sodium-activated potassium channe...
3          383  K<sub>Ca</sub>2.3  Calcium- and sodium-activated potassium channe...
4          384  K<sub>Ca</sub>3.1  Calcium- and sodium-activated potassium channe...
..         ...                ...                                                ...
142        586  Na<sub>v</sub>1.9     Voltage-gated sodium channels (Na<sub>V</sub>)
143        746     H<sub>v</sub>1     Voltage-gated proton channel  (H<sub>v</sub>1)
144        747               RyR1                          Ryanodine receptors (RyR)
145        748               RyR2                          Ryanodine receptors (RyR)
146        749               RyR3                          Ryanodine receptors (RyR)

[147 rows x 3 columns]

Generated SQL Results:
      object_id       channel_name  interaction_id  ...  interaction_type affinity_units affinity
0           505              TRPP2            5801  ...         Activator              -      NaN
1           584  Na<sub>v</sub>1.7           85661  ...         Inhibitor          pIC50     9.10
2           485              TRPA1           86088  ...         Activator          pEC50     6.29
3           485              TRPA1           86089  ...         Activator          pEC50     6.27
4           485              TRPA1           86090  ...         Activator          pEC50     6.30
...         ...                ...             ...  ...               ...            ...      ...
1694        583  Na<sub>v</sub>1.6           90855  ...         Inhibitor          pIC50     7.99
1695        583  Na<sub>v</sub>1.6           90856  ...         Inhibitor          pIC50     7.86
1696        579  Na<sub>v</sub>1.2           90857  ...         Inhibitor          pIC50     7.96
1697        583  Na<sub>v</sub>1.6           90854  ...         Inhibitor          pIC50     6.89
1698        583  Na<sub>v</sub>1.6           90853  ...         Inhibitor          pIC50     7.11

[1699 rows x 8 columns]

--- Processing Test Case 27 ---
Natural Language Query: What antimalarial ligands are approved drugs?
Expected SQL: select l.ligand_id, l.name, l.approved, l.in_gtmp from ligand l where l.in_gtmp is true and l.approved is true;
Generated SQL: SELECT l.ligand_id, l.name 
FROM ligand l 
WHERE l.approved = true AND l.ligand_id IN (
    SELECT l.ligand_id 
    FROM ligand l 
    WHERE l.gtmp_comments ILIKE '%antimalarial%' OR l.type ILIKE '%antimalarial%'
);

Expected SQL Results:
    ligand_id                name  approved  in_gtmp
0        9676           proguanil      True     True
1        9955          artemether      True     True
2        2342           quinidine      True     True
3        4252          mefloquine      True     True
4        4800       pyrimethamine      True     True
5        5535         chloroquine      True     True
6        6391          bortezomib      True     True
7        6464         doxycycline      True     True
8        9695          atovaquone      True     True
9        9957           artenimol      True     True
10       9969        lumefantrine      True     True
11      10018         amodiaquine      True     True
12      10019        halofantrine      True     True
13      10025         piperaquine      True     True
14       2510             quinine      True     True
15       7198  hydroxychloroquine      True     True
16       7489        panobinostat      True     True
17      10173         sulfadoxine      True     True
18      10916           mupirocin      True     True
19      10934             dapsone      True     True
20       6510        azithromycin      True     True
21       9722         tafenoquine      True     True
22       9956          artesunate      True     True
23      10607         clindamycin      True     True
24       9952          primaquine      True     True

Generated SQL Results:
    ligand_id           name
0        9955     artemether
1        2342      quinidine
2        4800  pyrimethamine
3        5535    chloroquine
4        9969   lumefantrine
5       10019   halofantrine
6        7489   panobinostat
7       10916      mupirocin
8       10934        dapsone
9        9722    tafenoquine
10       9956     artesunate

--- Processing Test Case 28 ---
Natural Language Query: Find enzymes with endogenous substrates that have no pharmacology to speak of?
Expected SQL: select o.object_id, o.name from object o where o.object_id in (select distinct object_id from enzyme) and o.object_id in (select distinct object_id from endo_ligand_pairings) and o.object_id not in (select distinct object_id from interaction where object_id is not null and ((affinity_units != '-' and affinity_units is not null) or (original_affinity_units is not null and original_affinity_units != '-') or (concentration_range is not null and concentration_range != '-' and concentration_range != '')));
Generated SQL: WITH enzyme_objects AS (
    SELECT e.object_id
    FROM enzyme e
),
endogenous_substrates AS (
    SELECT s.object_id
    FROM substrate s
    WHERE s.endogenous = true
),
enzymes_with_pharmacology AS (
    SELECT DISTINCT i.object_id
    FROM interaction i
    WHERE i.object_id IN (SELECT object_id FROM enzyme_objects)
),
enzymes_without_pharmacology AS (
    SELECT eo.object_id
    FROM enzyme_objects eo
    WHERE eo.object_id NOT IN (SELECT object_id FROM enzymes_with_pharmacology)
)

SELECT o.object_id, o.name
FROM object o
WHERE o.object_id IN (
    SELECT es.object_id
    FROM endogenous_substrates es
    WHERE es.object_id IN (SELECT object_id FROM enzymes_without_pharmacology)
);

Expected SQL Results:
   object_id                           name
0       3201  chymotrypsin like elastase 2A
1       1409                    PLC&delta;1
2       1404                     PLC&beta;2
3       1280             adenylyl cyclase 3
4       1285             adenylyl cyclase 8

Generated SQL Results:
   object_id                                        name
0       1626                                  Caspase 10
1       1262                        Pyruvate carboxylase
2       1390                                       E-LOX
3       1277           Phosphatidylserine decarboxylase 
4       1265                  Propionyl-CoA carboxylase 
5       1270                   L-Arginine decarboxylase 
6       1445  L-Cysteine:2-oxoglutarate aminotransferase

--- Processing Test Case 29 ---
Natural Language Query: What ligands, not in human, interact with GABAB1
Expected SQL: select l.ligand_id, l.name, l.type, o.object_id, o.name, i.type, i.action,i.species_id  from interaction i, ligand l, object o where i.object_id in (select object_id from object where name ilike 'GABA<sub>B1</sub>') and i.ligand_id=l.ligand_id and i.object_id=o.object_id and i.species_id not in (select species_id from species where name = 'Human');
Generated SQL: WITH target_family AS (
    SELECT object_id 
    FROM object 
    WHERE name ILIKE '%GABAB1%' OR abbreviation ILIKE '%GABAB1%'
), human_species AS (
    SELECT species_id 
    FROM species 
    WHERE name = 'Human'
)
SELECT DISTINCT i.ligand_id, l.name 
FROM interaction i
JOIN ligand l ON i.ligand_id = l.ligand_id
WHERE i.object_id IN (SELECT object_id FROM target_family)
AND i.species_id NOT IN (SELECT species_id FROM human_species);

Expected SQL Results:
    ligand_id                        name               type  ...        type        action species_id
0        1081                      3-APPA  Synthetic organic  ...     Agonist       Agonist          3
1        1064                (-)-baclofen  Synthetic organic  ...     Agonist  Full agonist          3
2        1072                   CGP 62349  Synthetic organic  ...  Antagonist    Antagonist          3
3        1067                        GABA         Metabolite  ...     Agonist  Full agonist          3
4        1068          2-hydroxy-saclofen  Synthetic organic  ...  Antagonist    Antagonist          3
5        1070                  CGP 54626A  Synthetic organic  ...  Antagonist    Antagonist          3
6        1071                  CGP 56999A  Synthetic organic  ...  Antagonist    Antagonist          3
7        1073                   CGP 64213  Synthetic organic  ...  Antagonist    Antagonist          3
8        1074                   CGP 71872  Synthetic organic  ...  Antagonist    Antagonist          3
9        1076  [<sup>125</sup>I]CGP 64213  Synthetic organic  ...  Antagonist    Antagonist          3
10       1077  [<sup>125</sup>I]CGP 71872  Synthetic organic  ...  Antagonist    Antagonist          3
11       1078                    saclofen  Synthetic organic  ...  Antagonist    Antagonist          3
12       1075                   SCH 50911  Synthetic organic  ...  Antagonist    Antagonist          3
13       1069                   CGP 35348  Synthetic organic  ...  Antagonist    Antagonist          3

[14 rows x 8 columns]

Generated SQL Results:
Error executing generated SQL.

--- Processing Test Case 30 ---
Natural Language Query: How many antibodies with binding data are there in GtoPdb? 
Expected SQL: select count(distinct l.ligand_id) from interaction i, ligand l where ((i.affinity_units is not null and i.affinity_units != '-' and i.affinity_units != '') or (i.concentration_range is not null and i.concentration_range != '-' and i.concentration_range != '')) and i.ligand_id=l.ligand_id and l.type='Antibody';
Generated SQL: SELECT COUNT(DISTINCT i.ligand_id) AS antibody_count
FROM interaction i
JOIN ligand l ON i.ligand_id = l.ligand_id
WHERE l.type = 'Antibody'
AND (
      (i.affinity_units IS NOT NULL AND i.affinity_units != '-' AND i.affinity_units != '')
   OR (i.original_affinity_units IS NOT NULL AND i.original_affinity_units != '-')
   OR (i.concentration_range IS NOT NULL AND i.concentration_range != '-' AND i.concentration_range != '')
);

Expected SQL Results:
   count
0    260

Generated SQL Results:
   antibody_count
0             260

--- Processing Test Case 31 ---
Natural Language Query: List all fatty acid binding proteins and their human gene identifiers
Expected SQL: select o.object_id, o.name, si.official_gene_id, si.gene_name from object o left join structural_info si on si.object_id=o.object_id where o.object_id in (select object_id from receptor2family where family_id in ((WITH RECURSIVE subfamilies AS ( SELECT group_id, family_id from grouping where group_id in (select family_id from family where name ilike '%Fatty acid-binding proteins%') UNION SELECT e.group_id, e.family_id from grouping e INNER JOIN subfamilies s ON s.family_id=e.group_id) SELECT family_id FROM subfamilies order by family_id) union select family_id from family where family_id in (select family_id from family where name ilike '%Fatty acid-binding proteins%'))) and si.species_id in (select species_id from species where name = 'Human');
Generated SQL: SELECT o.object_id, o.name AS protein_name, si.official_gene_id AS human_gene_id
FROM object o
JOIN structural_info si ON o.object_id = si.object_id
WHERE o.name ILIKE '%fatty acid binding protein%' 
AND si.species_id = (SELECT species_id FROM species WHERE name = 'Human');

Expected SQL Results:
    object_id                                      name official_gene_id gene_name
0        2533              fatty acid binding protein 3             3557     FABP3
1        2544               peripheral myelin protein 2             9117      PMP2
2        2546                 retinol binding protein 1             9919      RBP1
3        2549                 retinol binding protein 4             9922      RBP4
4        2529  cellular retinoic acid binding protein 1             2338    CRABP1
5        2530  cellular retinoic acid binding protein 2             2339    CRABP2
6        2548                 retinol binding protein 3             9921      RBP3
7        2531              fatty acid binding protein 1             3555     FABP1
8        2532              fatty acid binding protein 2             3556     FABP2
9        2545           retinaldehyde binding protein 1            10024     RLBP1
10       2534              fatty acid binding protein 4             3559     FABP4
11       2535              fatty acid binding protein 5             3560     FABP5
12       2538              fatty acid binding protein 9             3563     FABP9
13       2536              fatty acid binding protein 6             3561     FABP6
14       2547                 retinol binding protein 2             9920      RBP2
15       2550                 retinol binding protein 5            15847      RBP5
16       2551                 retinol binding protein 7            30316      RBP7
17       2537              fatty acid binding protein 7             3562     FABP7
18       2584             fatty acid binding protein 12            34524    FABP12

Generated SQL Results:
   object_id                   protein_name human_gene_id
0       2533   fatty acid binding protein 3          3557
1       2531   fatty acid binding protein 1          3555
2       2532   fatty acid binding protein 2          3556
3       2534   fatty acid binding protein 4          3559
4       2535   fatty acid binding protein 5          3560
5       2538   fatty acid binding protein 9          3563
6       2536   fatty acid binding protein 6          3561
7       2537   fatty acid binding protein 7          3562
8       2584  fatty acid binding protein 12         34524

--- Processing Test Case 32 ---
Natural Language Query: Find synthetic organic ligands with a molecular weight less than 500
Expected SQL: select l.ligand_id, l.name, l.type, lp.molecular_weight from ligand l, ligand_physchem lp where l.ligand_id=lp.ligand_id and lp.molecular_weight < 500;
Generated SQL: SELECT l.ligand_id, l.name, lp.molecular_weight
FROM ligand l
JOIN ligand_physchem lp ON l.ligand_id = lp.ligand_id
WHERE l.type = 'Synthetic organic' AND lp.molecular_weight < 500;

Expected SQL Results:
      ligand_id           name               type  molecular_weight
0          1058    acetic acid         Metabolite         60.021129
1          6627    hexadecanal  Synthetic organic        240.245316
2          1640      naltriben  Synthetic organic        415.178358
3          6277   acetaldehyde         Metabolite         44.026215
4           427            CPX  Synthetic organic        236.127326
...         ...            ...                ...               ...
7745      12397  azidamfenicol  Synthetic organic        295.091669
7746      12637           EN67  Synthetic organic        278.279438
7747      12772      sutezolid  Synthetic organic        353.413402
7748      12921    sarecycline  Synthetic organic        487.503292
7749      12923    florfenicol  Synthetic organic        358.214688

[7750 rows x 4 columns]

Generated SQL Results:
      ligand_id           name  molecular_weight
0          6627    hexadecanal        240.245316
1          1640      naltriben        415.178358
2           427            CPX        236.127326
3          3442         GW9662        276.030170
4           345     vinburnine        294.173213
...         ...            ...               ...
6989      12397  azidamfenicol        295.091669
6990      12637           EN67        278.279438
6991      12772      sutezolid        353.413402
6992      12921    sarecycline        487.503292
6993      12923    florfenicol        358.214688

[6994 rows x 3 columns]

--- Processing Test Case 33 ---
Natural Language Query: List chemical structures for BACE1 that have pAct > 7 and order these high to low
Expected SQL: select l.ligand_id, l.name, l.type, o.object_id, o.name, i.type, i.action, case when i.affinity_median is null then case when i.affinity_high is null then i.affinity_low else i.affinity_high end else i.affinity_median end as affinity, i.affinity_units from interaction i, ligand l, object o where i.object_id in (select object_id from object where name ilike '%BACE1%' or abbreviation ilike '%BACE1%') and i.ligand_id=l.ligand_id and i.object_id=o.object_id and case when i.affinity_median is null then case when i.affinity_high is null then i.affinity_low > 7 else i.affinity_high > 7  end else i.affinity_median > 7 end order by 8 desc;
Generated SQL: SELECT 
    l.ligand_id, 
    l.name, 
    ls.isomeric_smiles, 
    ls.isomeric_standard_inchi, 
    ls.isomeric_standard_inchi_key, 
    i.type, 
    i.action, 
    CASE 
        WHEN i.affinity_median IS NULL THEN 
            CASE 
                WHEN i.affinity_high IS NULL THEN i.affinity_low 
                ELSE i.affinity_high 
            END 
        ELSE i.affinity_median 
    END AS affinity, 
    i.affinity_units
FROM 
    interaction i
JOIN 
    ligand l ON i.ligand_id = l.ligand_id
JOIN 
    ligand_structure ls ON i.ligand_id = ls.ligand_id
WHERE 
    i.object_id IN (
        SELECT object_id 
        FROM object 
        WHERE name ILIKE '%BACE1%' OR abbreviation ILIKE '%BACE1%' 
        UNION 
        SELECT object_id 
        FROM synonym 
        WHERE synonym ILIKE '%BACE1%'
    ) 
    AND CASE 
            WHEN i.affinity_median IS NULL THEN 
                CASE 
                    WHEN i.affinity_high IS NULL THEN i.affinity_low > 7 
                    ELSE i.affinity_high > 7 
                END 
            ELSE i.affinity_median > 7 
        END
ORDER BY 
    affinity DESC;

Expected SQL Results:
    ligand_id                            name               type  ...       action affinity affinity_units
0       11775     compound 6 [PMID: 34553947]  Synthetic organic  ...   Inhibition     9.89            pKi
1        9982    compound 15 [PMID: 25699151]  Synthetic organic  ...   Inhibition     9.52          pIC50
2        8699                    verubecestat  Synthetic organic  ...  Competitive     9.47            pKi
3       10520                         AM-6494  Synthetic organic  ...   Inhibition     9.44          pIC50
4       10520                         AM-6494  Synthetic organic  ...   Inhibition     9.40          pIC50
5       10520                         AM-6494  Synthetic organic  ...   Inhibition     9.21          pIC50
6        9639                        AMG-8718  Synthetic organic  ...   Inhibition     9.15          pIC50
7        9831                     PF-06684511  Synthetic organic  ...   Inhibition     9.15          pIC50
8        9963                     atabecestat  Synthetic organic  ...   Inhibition     9.10            pKi
9        8698    compound 16 [PMID: 23412139]  Synthetic organic  ...  Competitive     8.77            pKi
10       8699                    verubecestat  Synthetic organic  ...  Competitive     8.76            pKi
11       6939                         AZ-4217  Synthetic organic  ...  Competitive     8.74            pKi
12       7789                    lanabecestat  Synthetic organic  ...  Competitive     8.66          pIC50
13      11751                    JNJ-67569762  Synthetic organic  ...   Inhibition     8.57          pIC50
14       6946  compound 11d  [PMID: 23981898]  Synthetic organic  ...  Competitive     8.40          pIC50
15       9822                          NB-360  Synthetic organic  ...   Inhibition     8.30          pIC50
16       9197     compound 9 [PMID: 26937601]  Synthetic organic  ...   Inhibition     8.30            pKi
17       6950     compound 2 [PMID: 22911925]  Synthetic organic  ...  Competitive     8.26          pIC50
18       9818                    elenbecestat  Synthetic organic  ...   Inhibition     8.15          pIC50
19       9943                     PF-06751979  Synthetic organic  ...   Inhibition     8.14          pIC50
20       8399    compound 13 [PMID: 23412139]  Synthetic organic  ...   Inhibition     8.11            pKi
21       9963                     atabecestat  Synthetic organic  ...   Inhibition     8.01          pIC50
22      12747                     umibecestat  Synthetic organic  ...   Inhibition     7.96          pIC50
23       6944                      oxazine 89  Synthetic organic  ...  Competitive     7.92          pIC50
24       7854     compound J [PMID: 21907142]  Synthetic organic  ...   Inhibition     7.74          pIC50
25       6475                       LY2886721  Synthetic organic  ...  Competitive     7.70          pIC50
26       7852        example 2 [WO2013004676]  Synthetic organic  ...   Inhibition     7.59          pIC50
27       6931                         AZD3839  Synthetic organic  ...  Competitive     7.58            pKi
28       9821                       RO5508887  Synthetic organic  ...   Inhibition     7.52          pIC50
29       7804                          AZ3971  Synthetic organic  ...  Competitive     7.52          pIC50

[30 rows x 9 columns]

Generated SQL Results:
    ligand_id                            name  ... affinity affinity_units
0       11775     compound 6 [PMID: 34553947]  ...     9.89            pKi
1        9982    compound 15 [PMID: 25699151]  ...     9.52          pIC50
2        8699                    verubecestat  ...     9.47            pKi
3       10520                         AM-6494  ...     9.44          pIC50
4       10520                         AM-6494  ...     9.40          pIC50
5       10520                         AM-6494  ...     9.21          pIC50
6        9639                        AMG-8718  ...     9.15          pIC50
7        9831                     PF-06684511  ...     9.15          pIC50
8        9963                     atabecestat  ...     9.10            pKi
9        8698    compound 16 [PMID: 23412139]  ...     8.77            pKi
10       8699                    verubecestat  ...     8.76            pKi
11       6939                         AZ-4217  ...     8.74            pKi
12       7789                    lanabecestat  ...     8.66          pIC50
13      11751                    JNJ-67569762  ...     8.57          pIC50
14       6946  compound 11d  [PMID: 23981898]  ...     8.40          pIC50
15       9822                          NB-360  ...     8.30          pIC50
16       9197     compound 9 [PMID: 26937601]  ...     8.30            pKi
17       6950     compound 2 [PMID: 22911925]  ...     8.26          pIC50
18       9818                    elenbecestat  ...     8.15          pIC50
19       9943                     PF-06751979  ...     8.14          pIC50
20       8399    compound 13 [PMID: 23412139]  ...     8.11            pKi
21       9963                     atabecestat  ...     8.01          pIC50
22      12747                     umibecestat  ...     7.96          pIC50
23       6944                      oxazine 89  ...     7.92          pIC50
24       7854     compound J [PMID: 21907142]  ...     7.74          pIC50
25       6475                       LY2886721  ...     7.70          pIC50
26       7852        example 2 [WO2013004676]  ...     7.59          pIC50
27       6931                         AZD3839  ...     7.58            pKi
28       9821                       RO5508887  ...     7.52          pIC50
29       7804                          AZ3971  ...     7.52          pIC50

[30 rows x 9 columns]

--- Processing Test Case 34 ---
Natural Language Query: Find any endogenous substrates of decarboxylases?
Expected SQL: select l.ligand_id, l.name, l.type, o.object_id, o.name, s.endogenous  from substrate s, ligand l, object o where s.object_id in (select object_id from object where object_id in (select object_id from receptor2family where family_id in((WITH RECURSIVE subfamilies AS ( SELECT group_id, family_id from grouping where group_id in (select family_id from family where name ilike 'decarboxylases') UNION SELECT e.group_id, e.family_id from grouping e INNER JOIN subfamilies s ON s.family_id=e.group_id) SELECT family_id FROM subfamilies order by family_id) union select family_id from family where family_id in (select family_id from family where name ilike 'decarboxylases')))) and s.ligand_id=l.ligand_id and s.object_id=o.object_id;
Generated SQL: WITH RECURSIVE decarboxylase_families AS (
    SELECT group_id, family_id
    FROM grouping
    WHERE group_id IN (
        SELECT family_id
        FROM family
        WHERE name ILIKE '%decarboxylase%'
    )
    UNION
    SELECT e.group_id, e.family_id
    FROM grouping e
    INNER JOIN decarboxylase_families s ON s.family_id = e.group_id
)
SELECT s.substrate_id, s.name, o.name AS object_name
FROM substrate s
JOIN object o ON s.object_id = o.object_id
WHERE s.endogenous = true
AND o.object_id IN (
    SELECT object_id 
    FROM receptor2family 
    WHERE family_id IN (
        SELECT family_id 
        FROM decarboxylase_families 
        UNION 
        SELECT family_id 
        FROM family 
        WHERE name ILIKE '%decarboxylase%'
    )
);

Expected SQL Results:
    ligand_id                          name  ...                                  name  endogenous
0        4671        5-hydroxy-L-tryptophan  ...  L-Aromatic amino-acid decarboxylase         True
1         721                    L-arginine  ...             L-Arginine decarboxylase         True
2        1369               L-glutamic acid  ...         Glutamic acid decarboxylase 1        True
3        1369               L-glutamic acid  ...         Glutamic acid decarboxylase 2        True
4         717                  L-tryptophan  ...  L-Aromatic amino-acid decarboxylase         True
5        3639                      levodopa  ...  L-Aromatic amino-acid decarboxylase         True
6         725                   L-ornithine  ...               Ornithine decarboxylase        True
7        3309               L-aspartic acid  ...         Glutamic acid decarboxylase 1        True
8        3309               L-aspartic acid  ...         Glutamic acid decarboxylase 2        True
9        3310                   L-histidine  ...               Histidine decarboxylase        True
10       3638            phosphatidylserine  ...     Phosphatidylserine decarboxylase         True
11       4786         S-adenosyl methionine  ...   S-Adenosylmethionine decarboxylase         True
12       5219                   malonyl-CoA  ...             Malonyl-CoA decarboxylase        True
13       8611  Deuterium-substituted L-DOPA  ...  L-Aromatic amino-acid decarboxylase        False

[14 rows x 6 columns]

Generated SQL Results:
    substrate_id               name                           object_name
0           1581  glutamyl peptides          &gamma;-Glutamyl carboxylase
1           1631               None  L-Aromatic amino-acid decarboxylase 
2           1611               None             L-Arginine decarboxylase 
3           1614               None         Glutamic acid decarboxylase 1
4           1615               None         Glutamic acid decarboxylase 2
5           1616               None                  Pyruvate carboxylase
6           1617               None              Acetyl-CoA carboxylase 1
7           1618               None            Propionyl-CoA carboxylase 
8           1610               None  L-Aromatic amino-acid decarboxylase 
9           1630               None  L-Aromatic amino-acid decarboxylase 
10          1612               None               Ornithine decarboxylase
11          1625               None              Acetyl-CoA carboxylase 1
12          1626               None         Glutamic acid decarboxylase 1
13          1627               None         Glutamic acid decarboxylase 2
14          1628               None               Histidine decarboxylase
15          1629               None     Phosphatidylserine decarboxylase 
16          1634               None   S-Adenosylmethionine decarboxylase 
17          1635               None                  Pyruvate carboxylase
18          1644               None             Malonyl-CoA decarboxylase
19          1646               None            Propionyl-CoA carboxylase 
20          1649               None              Acetyl-CoA carboxylase 2
21          1650               None              Acetyl-CoA carboxylase 2

--- Processing Test Case 35 ---
Natural Language Query: Write an essay on endothelian receptors antagonists
Expected SQL: select f.family_id, f.name, g.overview, g.comments, i.text from family f left join grac_family_text g on g.family_id=f.family_id left join introduction i on i.family_id=f.family_id where f.name ilike ('%endothelin%');
Generated SQL: -- Query to find all endothelin receptor antagonists and their interaction data
WITH RECURSIVE subfamilies AS (
    SELECT group_id, family_id 
    FROM grouping 
    WHERE group_id IN (
        SELECT family_id 
        FROM family 
        WHERE name ILIKE '%endothelin% receptors%'
    )
    UNION 
    SELECT e.group_id, e.family_id 
    FROM grouping e 
    INNER JOIN subfamilies s ON s.family_id=e.group_id
)
SELECT DISTINCT l.ligand_id, l.name, l.type, o.object_id, o.name AS target_name, i.type AS interaction_type, i.action, i.affinity_units, 
       CASE 
           WHEN i.affinity_median IS NULL THEN 
               CASE 
                   WHEN i.affinity_high IS NULL THEN i.affinity_low 
                   ELSE i.affinity_high 
               END 
           ELSE i.affinity_median 
       END AS affinity_value
FROM interaction i
JOIN ligand l ON i.ligand_id = l.ligand_id
JOIN object o ON i.object_id = o.object_id
WHERE i.object_id IN (
    SELECT object_id 
    FROM receptor2family 
    WHERE family_id IN (
        SELECT family_id 
        FROM subfamilies 
        UNION 
        SELECT family_id 
        FROM family 
        WHERE family_id IN (
            SELECT family_id 
            FROM family 
            WHERE name ILIKE '%endothelin% receptors%'
        )
    )
) 
AND i.type = 'Antagonist'
ORDER BY affinity_value DESC;

Expected SQL Results:
   family_id  ...                                               text
0         21  ...  <heading>General</heading><p>In mammals, the e...

[1 rows x 5 columns]

Generated SQL Results:
    ligand_id                       name               type  ...           action affinity_units affinity_value
0       13015                  edonentan  Synthetic organic  ...       Antagonist            pKi          11.00
1        3487                 atrasentan  Synthetic organic  ...       Antagonist            pKi          10.47
2       12286                clazosentan  Synthetic organic  ...       Antagonist            pKi           9.89
3         999                  PD-156707  Synthetic organic  ...       Antagonist            pKd           9.80
4        1002  [<sup>125</sup>I]PD164333  Synthetic organic  ...       Antagonist            pKd           9.80
5       12286                clazosentan  Synthetic organic  ...       Antagonist            pA2           9.50
6        3528                   SB209670  Synthetic organic  ...       Antagonist            pKB           9.40
7        3528                   SB209670  Synthetic organic  ...       Antagonist            pKB           9.40
8        7352                 macitentan  Synthetic organic  ...       Antagonist          pIC50           9.30
9         999                  PD-156707  Synthetic organic  ...       Antagonist            pA2           9.20
10       3479       [<sup>3</sup>H]S0139  Synthetic organic  ...       Antagonist            pKd           9.20
11       3487                 atrasentan  Synthetic organic  ...       Antagonist            pA2           9.20
12       1001  [<sup>125</sup>I]PD151242            Peptide  ...       Antagonist            pKd           9.10
13       1000                   SB234551  Synthetic organic  ...       Antagonist          pIC50           9.00
14       3519                   PD164333  Synthetic organic  ...       Antagonist            pKd           9.00
15       3508                 darusentan  Synthetic organic  ...       Antagonist            pKi           8.90
16      13016                 BMS-193884  Synthetic organic  ...       Antagonist            pKi           8.85
17       1003       [<sup>3</sup>H]BQ123            Peptide  ...       Antagonist            pKd           8.50
18      10070               aprocitentan  Synthetic organic  ...       Antagonist          pIC50           8.47
19       3913                    TAK 044            Peptide  ...       Antagonist            pA2           8.40
20       3913                    TAK 044            Peptide  ...       Antagonist            pA2           8.40
21       3539                 zibotentan  Synthetic organic  ...       Antagonist          pIC50           8.30
22       9651                     K-8794  Synthetic organic  ...       Antagonist          pIC50           8.22
23       1009                    A192621  Synthetic organic  ...       Antagonist            pKd           8.10
24       8448                 sparsentan  Synthetic organic  ...       Antagonist            pKi           8.03
25       1010                      BQ788  Synthetic organic  ...       Antagonist            pKd           8.00
26       3911                    RES7011            Peptide  ...       Antagonist          pIC50           8.00
27       3950                sitaxsentan  Synthetic organic  ...       Antagonist            pA2           8.00
28        998                   FR139317  Synthetic organic  ...  Inverse agonist          pIC50           7.90
29       3951                ambrisentan  Synthetic organic  ...       Antagonist          pIC50           7.66
30       1010                      BQ788  Synthetic organic  ...       Antagonist            pKd           7.50
31        997                      BQ123            Peptide  ...       Antagonist            pA2           7.40
32       8260                  avosentan  Synthetic organic  ...       Antagonist          pIC50           7.30
33       1011                 Ro 46-8443  Synthetic organic  ...       Antagonist          pIC50           7.20
34       3494                   bosentan  Synthetic organic  ...       Antagonist            pA2           7.20
35       3887                   IRL 2500            Peptide  ...       Antagonist            pKd           7.20
36       3494                   bosentan  Synthetic organic  ...       Antagonist            pKi           7.10
37       3951                ambrisentan  Synthetic organic  ...       Antagonist            pA2           7.10
38       3487                 atrasentan  Synthetic organic  ...       Antagonist            pKi           6.86
39      12286                clazosentan  Synthetic organic  ...       Antagonist            pKi           6.76
40      10070               aprocitentan  Synthetic organic  ...       Antagonist            pA2           6.70
41       7352                 macitentan  Synthetic organic  ...       Antagonist          pIC50           6.41
42      10070               aprocitentan  Synthetic organic  ...       Antagonist          pIC50           6.01
43       3494                   bosentan  Synthetic organic  ...       Antagonist            pA2           6.00
44       3951                ambrisentan  Synthetic organic  ...       Antagonist          pIC50           5.92
45      10070               aprocitentan  Synthetic organic  ...       Antagonist            pA2           5.50
46      13016                 BMS-193884  Synthetic organic  ...       Antagonist            pKi           4.73

[47 rows x 9 columns]

--- Processing Test Case 36 ---
Natural Language Query: What compounds, that are not approved drugs, have evidence of being used in clinical trials?
Expected SQL: select l.ligand_id, l.name from ligand l where l.ligand_id in (select distinct ligand_id from ligand2clinical_trial lct) and l.approved is false;
Generated SQL: SELECT l.ligand_id, l.name
FROM ligand l
WHERE l.approved IS NOT TRUE
AND l.ligand_id IN (
    SELECT DISTINCT lig2ct.ligand_id
    FROM ligand2clinical_trial lig2ct
);

Expected SQL Results:
      ligand_id         name
0         12714        M8891
1         13314     RVT-1502
2         11232  camlipixant
3         12723   BMS-986202
4         11932   BMS-820132
...         ...          ...
1094      11789   laniquidar
1095      11801  reldesemtiv
1096      11830    donafenib
1097      12312   inclacumab
1098      12772    sutezolid

[1099 rows x 2 columns]

Generated SQL Results:
      ligand_id         name
0         12714        M8891
1         13314     RVT-1502
2         11232  camlipixant
3         12723   BMS-986202
4         11932   BMS-820132
...         ...          ...
1094      11789   laniquidar
1095      11801  reldesemtiv
1096      11830    donafenib
1097      12312   inclacumab
1098      12772    sutezolid

[1099 rows x 2 columns]

--- Processing Test Case 37 ---
Natural Language Query: Find GPCR agnonists with pKi affinities greater than 10
Expected SQL: select distinct ligand_id from interaction where object_id in (select distinct object_id from object where object_id in (select distinct object_id from receptor2family rf where family_id in (select family_id from family where type in ('gpcr')))) and type ='Agonist' and affinity_units ='pKi' and affinity_median >10;
Generated SQL: SELECT l.ligand_id, l.name, i.object_id, o.name AS target_name, 
       CASE 
           WHEN i.affinity_median IS NULL THEN 
               CASE 
                   WHEN i.affinity_high IS NULL THEN i.affinity_low 
                   ELSE i.affinity_high 
               END 
           ELSE i.affinity_median 
       END AS affinity,
       i.affinity_units
FROM ligand l
JOIN interaction i ON l.ligand_id = i.ligand_id
JOIN object o ON i.object_id = o.object_id
WHERE i.object_id IN (SELECT object_id FROM gpcr)
  AND i.type = 'Agonist'
  AND i.affinity_units = 'pKi'
  AND CASE 
          WHEN i.affinity_median IS NULL THEN 
              CASE 
                  WHEN i.affinity_high IS NULL THEN i.affinity_low 
                  ELSE i.affinity_high 
              END 
          ELSE i.affinity_median 
      END > 10;

Expected SQL Results:
    ligand_id
0          19
1         292
2         693
3         859
4         941
5        1141
6        1350
7        1351
8        1356
9        1469
10       1489
11       1504
12       1512
13       1513
14       1515
15       1527
16       1545
17       1551
18       1603
19       1683
20       2044
21       2046
22       2050
23       2052
24       7393
25       7671
26       7774
27       7775
28       7776
29       7780
30       7781
31       7923
32       8865
33       9006
34       9226
35      10040
36      10178
37      11691
38      12419

Generated SQL Results:
    ligand_id                              name  object_id             target_name  affinity affinity_units
0        1141           glucagon-like peptide 2        250          GLP-2 receptor     10.20            pKi
1         682                       &beta;-CGRP         48           CGRP receptor     11.00            pKi
2         693  [Cys(Et)2,7]&alpha;-CGRP (human)         48           CGRP receptor     10.50            pKi
3       11691                        ICI-199441        318        &kappa; receptor     10.40            pKi
4        1600              &alpha;-neoendorphin        318        &kappa; receptor     10.20            pKi
..        ...                               ...        ...                     ...       ...            ...
80        670                           JMV1116         42  B<sub>2</sub> receptor     10.20            pKi
81        941                        rotigotine        215  D<sub>2</sub> receptor     10.22            pKi
82       7671                       cariprazine        216  D<sub>3</sub> receptor     10.05            pKi
83       1989                           relaxin        351                   RXFP1     10.20            pKi
84        836                            CXCL11         70                   CXCR3     10.50            pKi

[85 rows x 6 columns]

--- Processing Test Case 38 ---
Natural Language Query: Find information on the clinical use of drugs targetting Glucagon receptors
Expected SQL: select distinct l.ligand_id, l.name, l.type, l.clinical_use from interaction i, ligand l, object o where i.object_id in (select object_id from object where object_id in (select object_id from receptor2family where family_id in((WITH RECURSIVE subfamilies AS ( SELECT group_id, family_id from grouping where group_id in (select family_id from family where name ilike '%Glucagon receptor%') UNION SELECT e.group_id, e.family_id from grouping e INNER JOIN subfamilies s ON s.family_id=e.group_id) SELECT family_id FROM subfamilies order by family_id) union select family_id from family where family_id in (select family_id from family where name ilike '%Glucagon receptor%')))) and i.ligand_id=l.ligand_id and i.object_id=o.object_id;
Generated SQL: WITH RECURSIVE subfamilies AS (
  SELECT group_id, family_id
  FROM grouping
  WHERE group_id IN (
    SELECT family_id
    FROM family
    WHERE name ILIKE '%Glucagon receptor%'
  )
  UNION
  SELECT e.group_id, e.family_id
  FROM grouping e
  INNER JOIN subfamilies s ON s.family_id = e.group_id
)
SELECT l.ligand_id, l.name, l.clinical_use, i.object_id, o.name AS target_name 
FROM interaction i
JOIN ligand l ON i.ligand_id = l.ligand_id
JOIN object o ON i.object_id = o.object_id
WHERE i.object_id IN (
  SELECT object_id
  FROM receptor2family
  WHERE family_id IN (
    SELECT family_id
    FROM subfamilies
    UNION
    SELECT family_id
    FROM family
    WHERE family_id IN (
      SELECT family_id
      FROM family
      WHERE name ILIKE '%Glucagon receptor%'
    )
  )
) AND l.clinical_use IS NOT NULL;

Expected SQL Results:
     ligand_id  ...                                       clinical_use
0         7386  ...  Albiglutide is approved to treat type 2 diabet...
1        11429  ...  An overview of the SURPASS phase 3 clinical st...
2         3293  ...                                               None
3         3785  ...                                               None
4         9135  ...  MK-0893 has completed Phase 2 clinical trials ...
..         ...  ...                                                ...
97        1105  ...                                                   
98        1144  ...                                                   
99        6524  ...                                                   
100       1154  ...                                               None
101       1103  ...                                                   

[102 rows x 4 columns]

Generated SQL Results:
     ligand_id                            name  ... object_id        target_name
0         2270                            GHRH  ...       247      GHRH receptor
1         3542  gastric inhibitory polypeptide  ...       248       GIP receptor
2         1140         glucagon-like peptide 2  ...       250     GLP-2 receptor
3         1110                         JV-1-39  ...       247      GHRH receptor
4         1111                         JV-1-40  ...       247      GHRH receptor
..         ...                             ...  ...       ...                ...
117      13316         maridebart cafraglutide  ...       248       GIP receptor
118      13316         maridebart cafraglutide  ...       248       GIP receptor
119      13383                     survodutide  ...       251  glucagon receptor
120      13383                     survodutide  ...       249     GLP-1 receptor
121      13383                     survodutide  ...       249     GLP-1 receptor

[122 rows x 5 columns]

--- Processing Test Case 39 ---
Natural Language Query: Which approved antibodies target ligands? 
Expected SQL: select l.ligand_id, l.name, l.type, l.approved from ligand l where l.type = 'Antibody' and l.approved is true and l.ligand_id in (select ligand_id from interaction where target_ligand_id is not null);
Generated SQL: SELECT i.object_id, (SELECT name FROM object o WHERE o.object_id = i.object_id) AS target_name, 
       i.ligand_id, (SELECT name FROM ligand l WHERE l.ligand_id = i.ligand_id) AS ligand_name
FROM interaction i
JOIN ligand l ON i.ligand_id = l.ligand_id
WHERE i.type = 'Antibody' AND l.approved = TRUE;

Expected SQL Results:
    ligand_id                name      type  approved
0        5004          infliximab  Antibody      True
1        7979         dinutuximab  Antibody      True
2       13085         adebrelimab  Antibody      True
3       12900           pozelimab  Antibody      True
4        8078         secukinumab  Antibody      True
5        8093       tildrakizumab  Antibody      True
6        8091          reslizumab  Antibody      True
7       13084        narlumosbart  Antibody      True
8        4860          adalimumab  Antibody      True
9        8298        idarucizumab  Antibody      True
10      12969          tarlatamab  Antibody      True
11       8717          evinacumab  Antibody      True
12      12790          crovalimab  Antibody      True
13      12962         sotatercept  Antibody      True
14       9292           burosumab  Antibody      True
15       6773         canakinumab  Antibody      True
16       6774  certolizumab pegol  Antibody      True
17       6885         ustekinumab  Antibody      True
18       6887           belimumab  Antibody      True
19       9846         mirikizumab  Antibody      True
20       6886           denosumab  Antibody      True
21       6884          eculizumab  Antibody      True
22       8325          aducanumab  Antibody      True
23      10492         envafolimab  Antibody      True
24      11341           naxitamab  Antibody      True
25      12202           lecanemab  Antibody      True
26      11420           faricimab  Antibody      True
27      12342         sugemalimab  Antibody      True
28       6771         bevacizumab  Antibody      True
29       6776           golimumab  Antibody      True
30       6779         ranibizumab  Antibody      True
31       7396          siltuximab  Antibody      True
32       7541          ixekizumab  Antibody      True
33       7685         mepolizumab  Antibody      True
34       7985          durvalumab  Antibody      True
35       7990        atezolizumab  Antibody      True
36       8001        tralokinumab  Antibody      True
37       8092         romosozumab  Antibody      True
38       8713        brolucizumab  Antibody      True
39       8735            avelumab  Antibody      True
40       8922        risankizumab  Antibody      True
41       8933         tezepelumab  Antibody      True
42       8967        galcanezumab  Antibody      True
43       9123        caplacizumab  Antibody      True
44       9295          emapalumab  Antibody      True
45       9208        fremanezumab  Antibody      True
46       9411         bimekizumab  Antibody      True
47      10168         ravulizumab  Antibody      True
48      10694         eptinezumab  Antibody      True
49      11182          concizumab  Antibody      True

Generated SQL Results:
     object_id                                        target_name  ligand_id   ligand_name
0       2760.0                    programmed cell death 1 (CD279)      10090    cemiplimab
1       2760.0                    programmed cell death 1 (CD279)      10090    cemiplimab
2       2760.0                    programmed cell death 1 (CD279)      10090    cemiplimab
3       2995.0                                                CD4      10208    ibalizumab
4          NaN                                               None      10168   ravulizumab
..         ...                                                ...        ...           ...
165     2760.0                    programmed cell death 1 (CD279)      12990    sintilimab
166     2760.0                    programmed cell death 1 (CD279)      12990    sintilimab
167        NaN                                               None      13084  narlumosbart
168        NaN                                               None      13085   adebrelimab
169     2628.0  CD20 (membrane-spanning 4-domains, subfamily A...      13087   divozilimab

[170 rows x 4 columns]

--- Processing Test Case 40 ---
Natural Language Query: What antimalarial compounds are in the database?
Expected SQL: select ligand_id, name, gtmp_comments  from ligand where in_gtmp is true;
Generated SQL: SELECT l.ligand_id, l.name
FROM ligand l
WHERE l.in_gtmp IS TRUE;

Expected SQL Results:
     ligand_id                           name                                      gtmp_comments
0        11709    compound 1 [PMID: 33929818]                                                   
1        11822                   NCATS-SM3710                                                   
2        11958  compound 14a [WO2021155612A1]                                                   
3        10604   compound 2h [PMID: 30664827]                                                   
4        10614                         BCH070                                                   
..         ...                            ...                                                ...
131      10611                         GSK030  GSK030 has asexual blood stage activity, poten...
132      10616                       WEHI-842  Future progression of peptidomimetic <i>Plasmo...
133      11109                   TCMDC-135051  <b>Potential Target/Mechanism Of Action:</b> T...
134      11469                        BRD9185  <b>Potential Target/Mechanism Of Action:</b> B...
135      11704                      MMV688533  The compound was awarded <a href="https://www....

[136 rows x 3 columns]

Generated SQL Results:
     ligand_id                           name
0        11709    compound 1 [PMID: 33929818]
1        11822                   NCATS-SM3710
2        11958  compound 14a [WO2021155612A1]
3        10604   compound 2h [PMID: 30664827]
4        10614                         BCH070
..         ...                            ...
131      10611                         GSK030
132      10616                       WEHI-842
133      11109                   TCMDC-135051
134      11469                        BRD9185
135      11704                      MMV688533

[136 rows x 2 columns]

--- Processing Test Case 41 ---
Natural Language Query: What are the selective antagonists for Leukotriene receptors and their affinities?
Expected SQL: select o.object_id, o.name as name, i.ligand_id, l.name, i.affinity_units,i.type,i.selective,case when i.affinity_median is null then case when i.affinity_high is null then i.affinity_low else i.affinity_high end else i.affinity_median end as affinity from object o, interaction i, ligand l where o.object_id in (select object_id from receptor2family where family_id in ((WITH RECURSIVE subfamilies AS ( SELECT group_id, family_id from grouping where group_id in (select family_id from family where name ilike '%Leukotriene receptors%') UNION SELECT e.group_id, e.family_id from grouping e INNER JOIN subfamilies s ON s.family_id=e.group_id) SELECT family_id FROM subfamilies order by family_id) union select family_id from family where family_id in (select family_id from family where name ilike '%Leukotriene receptors%'))) and o.object_id=i.object_id and ((i.affinity_units is not null and i.affinity_units != '-' and i.affinity_units != '') or (i.concentration_range is not null and i.concentration_range != '-' and i.concentration_range != '')) and i.ligand_id=l.ligand_id and i.type='Antagonist' and i.selectivity='Selective';
Generated SQL: WITH RECURSIVE subfamilies AS (
    SELECT group_id, family_id 
    FROM grouping 
    WHERE group_id IN (SELECT family_id FROM family WHERE name ILIKE '%Leukotriene receptors%')
    UNION
    SELECT e.group_id, e.family_id 
    FROM grouping e
    INNER JOIN subfamilies s ON s.family_id = e.group_id
)
SELECT l.ligand_id, l.name, l.type, o.object_id, o.name, i.affinity_units, 
    CASE 
        WHEN i.affinity_median IS NULL 
        THEN 
            CASE 
                WHEN i.affinity_high IS NULL 
                THEN i.affinity_low 
                ELSE i.affinity_high 
            END 
        ELSE i.affinity_median 
    END AS affinity
FROM interaction i
JOIN ligand l ON i.ligand_id = l.ligand_id
JOIN object o ON i.object_id = o.object_id
WHERE i.object_id IN (
    SELECT object_id 
    FROM receptor2family 
    WHERE family_id IN (
        SELECT family_id FROM subfamilies
        UNION 
        SELECT family_id FROM family WHERE family_id IN (SELECT family_id FROM family WHERE name ILIKE '%Leukotriene receptors%')
    )
)
AND i.type = 'Antagonist'
AND i.selective = TRUE
ORDER BY affinity;

Expected SQL Results:
    object_id                        name  ligand_id  ...        type selective affinity
0         269  CysLT<sub>1</sub> receptor       3358  ...  Antagonist     False     9.70
1         269  CysLT<sub>1</sub> receptor       3340  ...  Antagonist     False     8.55
2         270  CysLT<sub>2</sub> receptor       6196  ...  Antagonist      True     8.30
3         270  CysLT<sub>2</sub> receptor       6197  ...  Antagonist     False     7.42
4         270  CysLT<sub>2</sub> receptor       6196  ...  Antagonist      True     8.40
5         269  CysLT<sub>1</sub> receptor       6193  ...  Antagonist      True     8.10
6         223                        FPR2       1030  ...  Antagonist      True     6.00
7         269  CysLT<sub>1</sub> receptor       6193  ...  Antagonist     False     7.97
8         269  CysLT<sub>1</sub> receptor      10346  ...  Antagonist     False     8.00
9         269  CysLT<sub>1</sub> receptor      10581  ...  Antagonist      True     9.00
10        269  CysLT<sub>1</sub> receptor       3322  ...  Antagonist      True     8.90
11        269  CysLT<sub>1</sub> receptor       3329  ...  Antagonist     False     8.70
12        223                        FPR2       1040  ...  Antagonist      True     6.64
13        269  CysLT<sub>1</sub> receptor       3322  ...  Antagonist      True     8.74
14        269  CysLT<sub>1</sub> receptor       3327  ...  Antagonist     False     8.30
15        267    BLT<sub>1</sub> receptor       3325  ...  Antagonist     False     6.40
16        267    BLT<sub>1</sub> receptor       3368  ...  Antagonist     False     8.10
17        271                OXE receptor       6171  ...  Antagonist     False     6.30
18        267    BLT<sub>1</sub> receptor       6154  ...  Antagonist     False     8.80
19        270  CysLT<sub>2</sub> receptor       6196  ...  Antagonist      True     7.28
20        268    BLT<sub>2</sub> receptor       3351  ...  Antagonist      True     7.10
21        269  CysLT<sub>1</sub> receptor       3340  ...  Antagonist     False     8.64

[22 rows x 8 columns]

Generated SQL Results:
    ligand_id                                  name  ... affinity_units  affinity
0        3322                           zafirlukast  ...          pIC50      5.13
1        3322                           zafirlukast  ...          pIC50      5.15
2        3634                            pranlukast  ...          pIC50      5.44
3        1030                           t-Boc-FLFLF  ...          pIC50      6.00
4        3334                            pobilukast  ...            pA2      6.20
5        1040                                WRWWWW  ...          pIC50      6.64
6        5861                             iralukast  ...            pA2      6.80
7        3322                           zafirlukast  ...            pA2      6.90
8        3334                            pobilukast  ...            pKi      7.10
9        3634                            pranlukast  ...            pA2      7.10
10       3351                              LY255283  ...          pIC50      7.10
11       6196                  BayCysLT<sub>2</sub>  ...          pIC50      7.28
12       3334                            pobilukast  ...          pIC50      7.52
13       3322                           zafirlukast  ...          pIC50      7.70
14       5861                             iralukast  ...            pKi      7.80
15       6193                             verlukast  ...          pIC50      8.10
16       3334                            pobilukast  ...          pIC50      8.26
17       6196                  BayCysLT<sub>2</sub>  ...            pA2      8.30
18       3634                            pranlukast  ...          pIC50      8.37
19       6196                  BayCysLT<sub>2</sub>  ...            pA2      8.40
20      10002  triple modulator 10 [PMID: 29878767]  ...            pA2      8.70
21       3322                           zafirlukast  ...          pIC50      8.74
22       3634                            pranlukast  ...            pKi      8.80
23       3322                           zafirlukast  ...            pKi      8.90
24      10581         compound 13e [PMID: 31811124]  ...          pIC50      9.00
25       3322                           zafirlukast  ...          pIC50      9.59
26       3634                            pranlukast  ...          pIC50     10.00
27       3414             [<sup>3</sup>H]ICI-198615  ...            pKd     10.60

[28 rows x 7 columns]

--- Processing Test Case 42 ---
Natural Language Query: What is known about Opioid delta receptor agonists?
Expected SQL: select l.ligand_id, l.name, l.type, o.object_id, o.name, i.type, i.action, i.affinity_units from interaction i, ligand l, object o where i.object_id in (select object_id from object where object_id in (select object_id from receptor2family where family_id in ((WITH RECURSIVE subfamilies AS ( SELECT group_id, family_id from grouping where group_id in (select family_id from family where name ilike '%opioid receptor%') UNION SELECT e.group_id, e.family_id from grouping e INNER JOIN subfamilies s ON s.family_id=e.group_id) SELECT family_id FROM subfamilies order by family_id) union select family_id from family where family_id in (select family_id from family where name ilike '%opioid receptor%')))) and i.type='Agonist' and i.ligand_id=l.ligand_id and i.object_id=o.object_id and o.name ilike '%delta%';
Generated SQL: WITH RECURSIVE subfamilies AS (
    SELECT group_id, family_id 
    FROM grouping 
    WHERE group_id IN (SELECT family_id FROM family WHERE name ILIKE '%Opioid delta receptor%')
    UNION 
    SELECT e.group_id, e.family_id 
    FROM grouping e 
    INNER JOIN subfamilies s ON s.family_id = e.group_id
)
SELECT 
    l.ligand_id, 
    l.name AS ligand_name, 
    l.type AS ligand_type, 
    o.object_id, 
    o.name AS target_name, 
    i.type AS interaction_type, 
    i.action, 
    i.affinity_units, 
    CASE 
        WHEN i.affinity_median IS NULL THEN 
            CASE 
                WHEN i.affinity_high IS NULL THEN i.affinity_low 
                ELSE i.affinity_high 
            END 
        ELSE i.affinity_median 
    END AS affinity 
FROM 
    interaction i
JOIN 
    ligand l ON i.ligand_id = l.ligand_id
JOIN 
    object o ON i.object_id = o.object_id
WHERE 
    i.object_id IN (
        SELECT object_id 
        FROM receptor2family 
        WHERE family_id IN (
            SELECT family_id 
            FROM subfamilies
            UNION 
            SELECT family_id 
            FROM family 
            WHERE name ILIKE '%Opioid delta receptor%'
        )
    )
    AND i.type = 'Agonist'
ORDER BY 
    affinity DESC;

Expected SQL Results:
    ligand_id                          name               type  ...     type           action affinity_units
0        1625                     etorphine  Synthetic organic  ...  Agonist     Full agonist            pKi
1        1607                         DADLE            Peptide  ...  Agonist     Full agonist            pKi
2        1612  [<sup>3</sup>H]diprenorphine  Synthetic organic  ...  Agonist     Full agonist            pKi
3        1618              dynorphin-(1-11)            Peptide  ...  Agonist     Full agonist            pKi
4        1615                 deltorphin II            Peptide  ...  Agonist     Full agonist            pKi
..        ...                           ...                ...  ...      ...              ...            ...
60       9005                   AR-M1000390  Synthetic organic  ...  Agonist          Agonist          pIC50
61       9006                       UFP-512  Synthetic organic  ...  Agonist          Agonist            pKi
62       9294                       BU08028  Synthetic organic  ...  Agonist  Partial agonist            pKi
63       8866                  cebranopadol  Synthetic organic  ...  Agonist          Agonist            pKi
64      13395                     atoxifent  Synthetic organic  ...  Agonist          Agonist          pEC50

[65 rows x 8 columns]

Generated SQL Results:
Error executing generated SQL.

--- Processing Test Case 43 ---
Natural Language Query: What compounds have a role in treating arthritis?
Expected SQL: select idl.ligand_id, l.name, idl.comment, d.name from immuno_disease2ligand idl, ligand l, disease d where idl.disease_id in (select disease_id from disease where name ilike '%arthritis%' union select disease_id from disease2synonym where synonym ilike '%arthritis%') and idl.ligand_id=l.ligand_id and d.disease_id=idl.disease_id;
Generated SQL: SELECT 
    idl.ligand_id, 
    l.name, 
    idl.comment, 
    d.name AS disease_name 
FROM 
    immuno_disease2ligand idl
JOIN 
    ligand l ON idl.ligand_id = l.ligand_id
JOIN 
    disease d ON idl.disease_id = d.disease_id
WHERE 
    idl.disease_id IN (
        SELECT disease_id 
        FROM disease 
        WHERE name ILIKE '%arthritis%' 
        UNION 
        SELECT disease_id 
        FROM disease2synonym 
        WHERE synonym ILIKE '%arthritis%'
    );

Expected SQL Results:
     ligand_id          name                                            comment                  name
0          422  piclidenoson   Clinical candidate for RA (Phase 2 NCT01034306).  Rheumatoid arthritis
1          422  piclidenoson  Clinical candidate for OA of the knee (Phase 2...        Osteoarthritis
2         4820    fenoprofen  Approved NSAID used for many inflammatory cond...        Osteoarthritis
3         4860    adalimumab  Anti-TNF&alpha; monoclonal antibody therapy ap...  Rheumatoid arthritis
4         5668   doramapimod                 Phase 2 clinical candidate for RA.  Rheumatoid arthritis
..         ...           ...                                                ...                   ...
174      10370     namilumab  Phase 2 clinical candidate for RA: namilumab h...  Rheumatoid arthritis
175       4998          IL-6  IL-6 is known to drive arthritic inflammation ...  Rheumatoid arthritis
176      10464  elsubrutinib                          Clinical candidate for RA  Rheumatoid arthritis
177       9559  ritlecitinib  Phase 2 clinical candidate for RA (NCT02969044...  Rheumatoid arthritis
178      12917     ABBV-3373                   Investugational treatment for RA  Rheumatoid arthritis

[179 rows x 4 columns]

Generated SQL Results:
     ligand_id          name                                            comment          disease_name
0          422  piclidenoson   Clinical candidate for RA (Phase 2 NCT01034306).  Rheumatoid arthritis
1          422  piclidenoson  Clinical candidate for OA of the knee (Phase 2...        Osteoarthritis
2         4820    fenoprofen  Approved NSAID used for many inflammatory cond...        Osteoarthritis
3         4860    adalimumab  Anti-TNF&alpha; monoclonal antibody therapy ap...  Rheumatoid arthritis
4         5668   doramapimod                 Phase 2 clinical candidate for RA.  Rheumatoid arthritis
..         ...           ...                                                ...                   ...
174      10370     namilumab  Phase 2 clinical candidate for RA: namilumab h...  Rheumatoid arthritis
175       4998          IL-6  IL-6 is known to drive arthritic inflammation ...  Rheumatoid arthritis
176      10464  elsubrutinib                          Clinical candidate for RA  Rheumatoid arthritis
177       9559  ritlecitinib  Phase 2 clinical candidate for RA (NCT02969044...  Rheumatoid arthritis
178      12917     ABBV-3373                   Investugational treatment for RA  Rheumatoid arthritis

[179 rows x 4 columns]

--- Processing Test Case 44 ---
Natural Language Query: Find all the papers in the Guide that are listed as preprints (useful for housekeeping)
Expected SQL: select * from reference where pub_status ilike '%preprint%' or pub_status ilike '%pre-print%';
Generated SQL: SELECT reference_id, title, article_title, authors, url
FROM reference
WHERE type ILIKE '%preprint%' OR pub_status ILIKE '%preprint%';

Expected SQL Results:
    reference_id  ...                               article_title_vector
0          41957  ...  'class':6 'coronavirus':15 'design':2 'diseas'...
1          42064  ...  '2':12 'block':8 'cell':24 'class':3 'cov':11,...
2          42139  ...  '2':5 'associ':7 'b.1.617':12 'cleavag':16 'co...
3          42140  ...        'complet':2 'genom':7 'human':6 'sequenc':3
4          42305  ...  'design':8 'drug':7 'fashion':3 'hype':5 'rati...
..           ...  ...                                                ...
60         46152  ...  'analysi':5 'associ':4 'cardiomyopathi':14 'di...
61         46304  ...  'activ':3 'amelior':4 'diseas':9 'model':10 'p...
62         47293  ...  '2':6 'cov':5 'discoveri':1 'efficaci':14 'inf...
63         47301  ...  'class':7 'degrad':10 'discoveri':1 'first':5 ...
64         47330  ...  'cancer':15 'control':7 'g12c':6 'growth':9 'i...

[65 rows x 31 columns]

Generated SQL Results:
    reference_id     title  ...                                            authors   url
0          41957   bioRxiv  ...  Westberg M, Su Y, Zou X, Ning L, Hurst B, Tarb...  None
1          42064   bioRxiv  ...  Mahoney M, Damalanka VC, Tartell MA, Chung DH,...  None
2          42139   bioRxiv  ...  Peacock TP, Sheppard CM, Brown JC, Goonawardan...  None
3          42140   bioRxiv  ...  Nurk S, Koren S, Rhie A, Rautiainen M, Bzikadz...  None
4          42305  F1000Res  ...  Medina-Franco JL, Martinez-Mayorga K, Fernnde...  None
..           ...       ...  ...                                                ...   ...
59         46152   medRxiv  ...  Zheng SL, Henry A, Cannie D, Lee M, Miller D, ...  None
60         46304   bioRxiv  ...  Chin RM, Rakhit R, Ditsworth D, Wang C, Bartho...  None
61         47293   bioRxiv  ...  Garnsey MR, Robinson MC, Nguyen LT, Cardin R, ...  None
62         47301   bioRxiv  ...  Velez J, Han Y, Yim H, Yang P, Deng Z, Park KS...  None
63         47330   bioRxiv  ...  Ghazi PC, O'Toole KT, Srinivas Boggaram S, Sch...  None

[64 rows x 5 columns]

--- Processing Test Case 45 ---
Natural Language Query: Are there compounds which can block all adenosine, muscarinic, LPA, cannabinoid or dopamine receptors? Originally: Are there compounds which can block all adenosine (muscarinic, LPA, cannabinoid, dopamine) receptors?  
Expected SQL: select i.ligand_id, l.name, count(distinct i.object_id) as targets, f.name from interaction i, ligand l, family f, receptor2family r2f where i.object_id in (select object_id from receptor2family where family_id in((WITH RECURSIVE subfamilies AS ( SELECT group_id, family_id from grouping where group_id in (select family_id from family where (name ilike '%Adenosine receptors%' OR name ilike '%Acetylcholine receptors \(muscarinic\)%' OR name ilike '%Cannabinoid receptors%' OR name ilike '%Dopamine receptors%' or name ilike '%Lysophospholipid (LPA) receptors%')) UNION SELECT e.group_id, e.family_id from grouping e INNER JOIN subfamilies s ON s.family_id=e.group_id) SELECT family_id FROM subfamilies order by family_id) union select family_id from family where family_id in (select family_id from family where (name ilike '%Adenosine receptors%' OR name ilike '%Acetylcholine receptors \(muscarinic\)%' OR name ilike '%Cannabinoid receptors%' OR name ilike '%Dopamine receptors%' or name ilike '%Lysophospholipid (LPA) receptors%')))) and i.type in ('Channel blocker','Gating inhibitor','Inhibitor','Antagonist') and i.ligand_id=l.ligand_id and i.object_id=r2f.object_id and r2f.family_id=f.family_id group by i.ligand_id, l.name, f.name, f.family_id having count(distinct i.object_id) = (select count(distinct object_id) from object where object_id in (select object_id from receptor2family where family_id in((WITH RECURSIVE subfamilies AS ( SELECT group_id, family_id from grouping where group_id in (f.family_id) UNION SELECT e.group_id, e.family_id from grouping e INNER JOIN subfamilies s ON s.family_id=e.group_id) SELECT family_id FROM subfamilies order by family_id) union select family_id from family where family_id in (f.family_id)))) order by f.name,l.name;
Generated SQL: WITH RECURSIVE receptor_families AS (
    SELECT group_id, family_id 
    FROM grouping 
    WHERE group_id IN (
        SELECT family_id FROM family 
        WHERE name ILIKE '%adenosine%' 
        OR name ILIKE '%muscarinic%' 
        OR name ILIKE '%LPA%' 
        OR name ILIKE '%cannabinoid%' 
        OR name ILIKE '%dopamine%'
    )
    UNION
    SELECT e.group_id, e.family_id 
    FROM grouping e 
    INNER JOIN receptor_families s ON s.family_id = e.group_id
)
SELECT l.ligand_id, l.name, COUNT(DISTINCT rf.family_id) as receptor_families_count
FROM interaction i
JOIN ligand l ON i.ligand_id = l.ligand_id
JOIN receptor2family r2f ON i.object_id = r2f.object_id
JOIN receptor_families rf ON r2f.family_id = rf.family_id
WHERE i.type = 'Antagonist'
GROUP BY l.ligand_id, l.name
HAVING COUNT(DISTINCT rf.family_id) = (
    SELECT COUNT(DISTINCT family_id) 
    FROM family 
    WHERE name ILIKE '%adenosine%' 
    OR name ILIKE '%muscarinic%' 
    OR name ILIKE '%LPA%' 
    OR name ILIKE '%cannabinoid%' 
    OR name ILIKE '%dopamine%'
);

Expected SQL Results:
    ligand_id                                 name  targets                                  name
0       10104                      (S)-dimetindene        5  Acetylcholine receptors (muscarinic)
1         317  [<sup>3</sup>H]N-methyl scopolamine        5  Acetylcholine receptors (muscarinic)
2         318                   [<sup>3</sup>H]QNB        5  Acetylcholine receptors (muscarinic)
3         308                     <i>p</i>-F-HHSiD        5  Acetylcholine receptors (muscarinic)
4         307                               4-DAMP        5  Acetylcholine receptors (muscarinic)
..        ...                                  ...      ...                                   ...
72         62                       (+)-butaclamol        5                    Dopamine receptors
73         83                       chlorpromazine        5                    Dopamine receptors
74         38                            clozapine        5                    Dopamine receptors
75         86                          haloperidol        5                    Dopamine receptors
76         99                            spiperone        5                    Dopamine receptors

[77 rows x 4 columns]

Generated SQL Results:
Error executing generated SQL.

--- Processing Test Case 46 ---
Natural Language Query: What should I use to inhibit TRPM3 in cultured cells, and at what concentration?  
Expected SQL: select l.ligand_id, l.name, case when i.affinity_median is null then case when i.affinity_high is null then i.affinity_low else i.affinity_high end else i.affinity_median end as affinity, i.affinity_units, i.type, i.action from ligand l, interaction i where i.object_id in (select object_id from object where object_id in (select object_id from receptor2family where family_id in (select family_id from family where name ilike '%TRPM3%')) union select object_id from object where name ilike '%TRPM3%') and l.ligand_id=i.ligand_id and i.type in ('Channel blocker','Gating inhibitor','Inhibitor','Antagonist') and ((i.affinity_units is not null and i.affinity_units != '-' and i.affinity_units != '') or (i.concentration_range is not null and i.concentration_range != '-' and i.concentration_range != ''));
Generated SQL: SELECT l.ligand_id, l.name, i.affinity_low, i.affinity_median, i.affinity_high, i.affinity_units 
FROM interaction i
JOIN ligand l ON i.ligand_id = l.ligand_id
WHERE i.object_id IN (
    SELECT object_id 
    FROM object 
    WHERE name ILIKE '%TRPM3%'
    OR abbreviation ILIKE '%TRPM3%'
    OR object_id IN (
        SELECT object_id
        FROM synonym
        WHERE synonym ILIKE '%TRPM3%'
    )
) 
AND i.type ILIKE '%Inhibitor%';

Expected SQL Results:
    ligand_id                       name  affinity affinity_units              type      action
0        2714                 diclofenac      5.20          pIC50   Channel blocker        None
1        2402                maprotiline      5.80          pIC50   Channel blocker        None
2        5338                  primidone      6.20          pIC50   Channel blocker        None
3        8899  (<i>S</i>)-liquiritigenin      5.20          pIC50   Channel blocker        None
4       10298                 naringenin      5.20          pIC50   Channel blocker        None
5         708            Mg<sup>2+</sup>      2.00          pIC50   Channel blocker  Antagonist
6        2433                      2-APB      4.00          pIC50  Gating inhibitor  Antagonist
7        2426            Gd<sup>3+</sup>      4.00          pIC50   Channel blocker  Antagonist
8        2434            La<sup>3+</sup>      4.00          pIC50   Channel blocker  Antagonist
9        2401                  halothane      3.28          pIC50   Channel blocker  Antagonist
10       2503                 chloroform      3.78          pIC50   Channel blocker  Antagonist
11      10299             isosakuranetin      7.30          pIC50   Channel blocker        None

Generated SQL Results:
   ligand_id   name affinity_low  affinity_median affinity_high affinity_units
0       2433  2-APB         None              4.0          None          pIC50

--- Processing Test Case 47 ---
Natural Language Query: Find SMILES and InChiKey for alitretinoin
Expected SQL: select ls.isomeric_smiles, ls.isomeric_standard_inchi_key from ligand_structure ls, ligand l where ls.ligand_id = l.ligand_id and l.name = 'alitretinoin';
Generated SQL: SELECT l.name, ls.isomeric_smiles, ls.isomeric_standard_inchi_key
FROM ligand l
JOIN ligand_structure ls ON l.ligand_id = ls.ligand_id
WHERE l.name ILIKE '%alitretinoin%';

Expected SQL Results:
                                   isomeric_smiles  isomeric_standard_inchi_key
0  C/C(=C/C=C/C(=C/C(=O)O)/C)/C=C/C1=C(C)CCCC1(C)C  SHGAZHPCJJPHSC-ZVCIMWCZSA-N

Generated SQL Results:
           name                                  isomeric_smiles  isomeric_standard_inchi_key
0  alitretinoin  C/C(=C/C=C/C(=C/C(=O)O)/C)/C=C/C1=C(C)CCCC1(C)C  SHGAZHPCJJPHSC-ZVCIMWCZSA-N

--- Processing Test Case 48 ---
Natural Language Query: Is there recommended background reading on endothelin receptors?
Expected SQL: select r.reference_id, r.title, r.article_title, r.year, r.pubmed_id, fr.key_ref from reference r, grac_further_reading fr where r.reference_id=fr.reference_id and fr.family_id in ((WITH RECURSIVE subfamilies AS ( SELECT group_id, family_id from grouping where group_id in (select family_id from family where name ilike '%endothelin receptors%') UNION SELECT e.group_id, e.family_id from grouping e INNER JOIN subfamilies s ON s.family_id=e.group_id) SELECT family_id FROM subfamilies order by family_id) union select family_id from family where family_id in (select family_id from family where name ilike '%endothelin receptors%'));
Generated SQL: WITH RECURSIVE endothelin_family AS (
    SELECT family_id 
    FROM family 
    WHERE name ILIKE '%endothelin%receptor%'
    UNION
    SELECT e.group_id 
    FROM grouping e
    INNER JOIN endothelin_family ef ON ef.family_id = e.family_id
)
SELECT r.reference_id, r.title, r.article_title, r.authors, r.doi, r.pubmed_id 
FROM reference r
JOIN grac_further_reading gfr ON r.reference_id = gfr.reference_id
WHERE gfr.family_id IN (SELECT family_id FROM endothelin_family);

Expected SQL Results:
    reference_id                                   title  ... pubmed_id  key_ref
0          43561                      J Mol Cell Cardiol  ...  35339512    False
1          13988                 Int J Biochem Cell Biol  ...  18325824    False
2          28243                     Handb Exp Pharmacol  ...  24092342     True
3          21893                                Life Sci  ...  22884806    False
4          21894                                Life Sci  ...  22846215    False
5           3083                           Pharmacol Rev  ...  12037137     True
6          36073                             Physiol Res  ...  29947527     True
7          14942                           Pflugers Arch  ...  19967386    False
8          21895                            Hypertension  ...  23608655    False
9          28246                           Semin Nephrol  ...  25966344    False
10         28244                                Life Sci  ...  22967485    False
11          3096              Annu Rev Pharmacol Toxicol  ...  17002597    False
12         21890                           Pharmacol Res  ...  21352917    False
13         14940                             Physiol Rev  ...  21248162    False
14         21891                          Br J Pharmacol  ...  22670597    False
15         21892                          Br J Pharmacol  ...  22118774    False
16         14941  Am J Physiol Regul Integr Comp Physiol  ...  20237301    False
17         13995                   Trends Cardiovasc Med  ...  19232951    False
18         28245                          Br J Pharmacol  ...  25131455     True
19         32140                           Pharmacol Rev  ...  26956245     True
20         45083                         Nat Rev Cardiol  ...  30867577     True
21         45084                            Reproduction  ...  35167488     True
22         45085                   J Exp Clin Cancer Res  ...  33422090     True

[23 rows x 6 columns]

Generated SQL Results:
    reference_id                                   title  ...   doi pubmed_id
0           3083                           Pharmacol Rev  ...  None  12037137
1           3096              Annu Rev Pharmacol Toxicol  ...  None  17002597
2          13995                   Trends Cardiovasc Med  ...  None  19232951
3          34074                           Mol Pharmacol  ...  None  29348268
4          34075                           Mol Pharmacol  ...  None  29298813
5          34076                           Mol Pharmacol  ...  None  29326242
6          34130                           Nat Chem Biol  ...  None  29045379
7          14940                             Physiol Rev  ...  None  21248162
8          14942                           Pflugers Arch  ...  None  19967386
9          21890                           Pharmacol Res  ...  None  21352917
10         21891                          Br J Pharmacol  ...  None  22670597
11         21892                          Br J Pharmacol  ...  None  22118774
12         21894                                Life Sci  ...  None  22846215
13         21895                            Hypertension  ...  None  23608655
14         13988                 Int J Biochem Cell Biol  ...  None  18325824
15         14941  Am J Physiol Regul Integr Comp Physiol  ...  None  20237301
16         21893                                Life Sci  ...  None  22884806
17         28243                     Handb Exp Pharmacol  ...  None  24092342
18         28245                          Br J Pharmacol  ...  None  25131455
19         28244                                Life Sci  ...  None  22967485
20         28246                           Semin Nephrol  ...  None  25966344
21         32140                           Pharmacol Rev  ...  None  26956245
22         36073                             Physiol Res  ...        29947527
23         43561                      J Mol Cell Cardiol  ...  None  35339512
24         45083                         Nat Rev Cardiol  ...        30867577
25         45084                            Reproduction  ...        35167488
26         45085                   J Exp Clin Cancer Res  ...        33422090

[27 rows x 6 columns]

--- Processing Test Case 49 ---
Natural Language Query: Find apelin ligands that are radiolabelled together with their pKDs.
Expected SQL: select l.ligand_id, l.name, l.radioactive, case when i.affinity_median is null then case when i.affinity_high is null then i.affinity_low else i.affinity_high end else i.affinity_median end as affinity, i.affinity_units from ligand l, interaction i where i.object_id in (select object_id from object where object_id in (select object_id from receptor2family where family_id in (select family_id from family where name ilike '%apelin%')) union select object_id from object where name ilike '%apelin%') and l.ligand_id=i.ligand_id and l.radioactive is true;
Generated SQL: SELECT 
    l.ligand_id, 
    l.name, 
    i.affinity_units, 
    CASE 
        WHEN i.affinity_median IS NULL THEN 
            CASE 
                WHEN i.affinity_high IS NULL THEN i.affinity_low 
                ELSE i.affinity_high 
            END 
        ELSE i.affinity_median 
    END AS pKD
FROM 
    ligand l
JOIN 
    interaction i ON l.ligand_id = i.ligand_id
WHERE 
    l.name ILIKE '%apelin%' 
    AND l.radioactive IS TRUE 
    AND i.affinity_units = 'pKD';

Expected SQL Results:
   ligand_id                                               name  radioactive  affinity affinity_units
0        601        [<sup>125</sup>I](Pyr<sup>1</sup>)apelin-13         True       9.5            pKd
1        604  [<sup>3</sup>H](Pyr<sup>1</sup>)[Met(0)11]-ape...         True       8.6            pKd
2        602                         [<sup>125</sup>I]apelin-13         True       9.2            pKd
3       3761  [<sup>125</sup>I][Glp<sup>65</sup>Nle<sup>75</...         True      10.7            pKd
4        603  [<sup>125</sup>I][Nle<sup>75</sup>,Tyr<sup>77<...         True      11.2            pKd

Generated SQL Results:
Error executing generated SQL.

--- Processing Test Case 50 ---
Natural Language Query: Find natural products ligands, that meet lipinski rule-of-5 and have SMILES
Expected SQL: select l.ligand_id, l.name, l.type, ls.isomeric_smiles from ligand l, ligand_physchem lp, ligand_structure ls where l.ligand_id=lp.ligand_id and lp.lipinski_s_rule_of_five = 0 and l.type = 'Natural product' and l.ligand_id=ls.ligand_id;
Generated SQL: SELECT l.ligand_id, l.name, l.type, ls.isomeric_smiles, lp.hydrogen_bond_acceptors, lp.hydrogen_bond_donors, lp.rotatable_bonds_count, lp.topological_polar_surface_area, lp.molecular_weight, lp.xlogp
FROM ligand l
JOIN ligand_physchem lp ON l.ligand_id = lp.ligand_id
JOIN ligand_structure ls ON l.ligand_id = ls.ligand_id
WHERE l.type = 'Natural product'
  AND (lp.hydrogen_bond_acceptors <= 10 AND lp.hydrogen_bond_donors <= 5 AND lp.molecular_weight <= 500 AND lp.xlogp <= 5)
  AND ls.isomeric_smiles IS NOT NULL;

Expected SQL Results:
     ligand_id  ...                                    isomeric_smiles
0        12130  ...  Cc1ccc([nH]1)C(=O)O[C@H]1[C@H]([C@@H](OC([C@@H...
1        12129  ...  Cc1ccc([nH]1)C(=O)O[C@@H]1[C@@H]([C@H](C(O[C@H...
2        12128  ...  Cc1ccc([nH]1)C(=O)O[C@H]1[C@H]([C@@H](OC([C@@H...
3        12021  ...  Cc1c(ccc2c1oc(=O)c(c2O)NC(=O)c1cc(c(cc1)O)CC=C...
4        11377  ...               COc1c(O)cc(c2c1n(C)c1c(c2=O)cccc1O)O
..         ...  ...                                                ...
216      13283  ...                             CC1=C(C(CC=C1)(C)C)C=O
217      13327  ...  COC1=C(C(=C(C(=C1)O)CC2=CC=CC=C2O)O)C(=O)CCC3=...
218      13363  ...  C=C[C@H]1CN2CC[C@H]1C[C@@H]2[C@H](C3=CC=NC4=CC...
219      13376  ...         COC1=CC(=CC(=C1OC)OC)/C=C/C(=O)N2CCC=CC2=O
220      13407  ...     CCCCCC1=CC(O)=C(C/C=C(\C)/CCC(O)C(C)=C)C(O)=C1

[221 rows x 4 columns]

Generated SQL Results:
     ligand_id                                 name  ... molecular_weight  xlogp
0        11377                       Citrusinine II  ...       287.079373  3.371
1        11372                              sesamin  ...       354.110338  2.746
2        11353                            berberine  ...       336.123583  4.701
3        11306                           borrelidin  ...       489.309038  4.675
4        11291                             psilocin  ...       204.126263  1.633
..         ...                                  ...  ...              ...    ...
196      13283                             safranal  ...       150.217934  2.450
197      13327         compound 11 [PMID: 30694059]  ...       394.418052  2.284
198      13363                           cinchonine  ...       294.391490  1.393
199      13376                       piperlongumine  ...       317.337112  1.100
200      13407  phytocannabinoid 6 [PMID: 38408345]  ...       332.477773  4.677

[201 rows x 10 columns]

--- Processing Test Case 51 ---
Natural Language Query: What are the affinity values for SLC29 family inhibitors?
Expected SQL: select o.object_id, o.name as name, i.ligand_id, l.name, i.affinity_units, case when i.affinity_median is null then case when i.affinity_high is null then i.affinity_low else i.affinity_high end else i.affinity_median end as affinity from object o, interaction i, ligand l where o.object_id in (select object_id from receptor2family where family_id in ((WITH RECURSIVE subfamilies AS ( SELECT group_id, family_id from grouping where group_id in (select family_id from family where name ilike '%SLC29 family%') UNION SELECT e.group_id, e.family_id from grouping e INNER JOIN subfamilies s ON s.family_id=e.group_id) SELECT family_id FROM subfamilies order by family_id) union select family_id from family where family_id in (select family_id from family where name ilike '%SLC29 family%'))) and o.object_id=i.object_id and ((i.affinity_units is not null and i.affinity_units != '-' and i.affinity_units != '') or (i.concentration_range is not null and i.concentration_range != '-' and i.concentration_range != '')) and i.ligand_id=l.ligand_id;
Generated SQL: WITH RECURSIVE subfamilies AS (
    SELECT group_id, family_id 
    FROM grouping 
    WHERE group_id IN (
        SELECT family_id 
        FROM family 
        WHERE name ILIKE '%SLC29%'
    )
    UNION 
    SELECT e.group_id, e.family_id 
    FROM grouping e 
    INNER JOIN subfamilies s ON s.family_id = e.group_id
)
SELECT i.ligand_id, l.name, i.affinity_high, i.affinity_median, i.affinity_low, i.affinity_units
FROM interaction i
JOIN ligand l ON i.ligand_id = l.ligand_id
WHERE i.object_id IN (
    SELECT object_id 
    FROM receptor2family 
    WHERE family_id IN (
        SELECT family_id 
        FROM subfamilies 
        UNION 
        SELECT family_id 
        FROM family 
        WHERE family_id IN (
            SELECT family_id 
            FROM family 
            WHERE name ILIKE '%SLC29%'
        )
    )
)
AND i.type = 'Inhibitor';

Expected SQL Results:
    object_id                                    name  ...  affinity_units affinity
0        1120   Plasma membrane monoamine transporter  ...             pKi     5.90
1        1120   Plasma membrane monoamine transporter  ...             pKi     4.64
2        1120   Plasma membrane monoamine transporter  ...             pKi     4.49
3        1120   Plasma membrane monoamine transporter  ...             pKi     7.00
4        1117  Equilibrative nucleoside transporter 1  ...             pKi     7.30
5        1117  Equilibrative nucleoside transporter 1  ...             pKd     9.30
6        1120   Plasma membrane monoamine transporter  ...             pKi     3.30
7        1120   Plasma membrane monoamine transporter  ...             pKi     4.73
8        1120   Plasma membrane monoamine transporter  ...             pKi     4.60
9        1120   Plasma membrane monoamine transporter  ...             pKi     4.57
10       1120   Plasma membrane monoamine transporter  ...             pKi     5.99
11       1117  Equilibrative nucleoside transporter 1  ...             pKi     9.40
12       1117  Equilibrative nucleoside transporter 1  ...             pKi     9.00
13       1117  Equilibrative nucleoside transporter 1  ...             pKi     8.80
14       1117  Equilibrative nucleoside transporter 1  ...             pKi     9.60
15       1117  Equilibrative nucleoside transporter 1  ...             pKi     9.30
16       1117  Equilibrative nucleoside transporter 1  ...             pKi     9.70

[17 rows x 6 columns]

Generated SQL Results:
    ligand_id                                      name  ... affinity_low  affinity_units
0        4807                              dipyridamole  ...         None             pKi
1        8485              compound 48 [PMID: 25815140]  ...         None           pIC50
2         203                                fluoxetine  ...         None             pKi
3        2399                               desipramine  ...         None             pKi
4        8482                               decynium 22  ...         None             pKi
5        8837              compound 16 [PMID: 19097778]  ...         None             pKi
6        1765                                ticagrelor  ...         None             pKi
7        1231                                cimetidine  ...         None             pKi
8        2406                                 verapamil  ...         None             pKi
9        2342                                 quinidine  ...         None             pKi
10       2510                                   quinine  ...         None             pKi
11       4607                              rhodamine123  ...         None             pKi
12       4734                                   KF24345  ...         None             pKi
13       4717                                   dilazep  ...         None             pKi
14       4807                              dipyridamole  ...         None             pKi
15       4590                                draflazine  ...         None             pKi
16       4513                                    NBTGR   ...         None             pKi
17       4512  nitrobenzylmercaptopurine ribonucleoside  ...         None             pKi

[18 rows x 6 columns]
==================================================
Total test queries executed: 26
Successful test queries: 22
None count: 4
None IDs: 81, 18, 11, 71
Empty count: 0
Empty IDs: 
==================================================
