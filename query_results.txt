Test Set Evaluation Results
==================================================
Total test queries executed: 0
Successful test queries: 0
None count: 0
None IDs: 
Empty count: 0
Empty IDs: 
==================================================

--- Processing Test Case 39 ---
Natural Language Query: Which approved antibodies target ligands? 
Expected SQL: select l.ligand_id, l.name, l.type, l.approved from ligand l where l.type = 'Antibody' and l.approved is true and l.ligand_id in (select ligand_id from interaction where target_ligand_id is not null);
Generated SQL: SELECT DISTINCT l.ligand_id, l.name 
FROM interaction i 
JOIN ligand l ON i.ligand_id = l.ligand_id 
WHERE l.type = 'Antibody' 
AND l.approved = true 
AND i.object_id IS NOT NULL;

Expected SQL Results:
    ligand_id                name      type  approved
0        5004          infliximab  Antibody      True
1        7979         dinutuximab  Antibody      True
2       13085         adebrelimab  Antibody      True
3       12900           pozelimab  Antibody      True
4        8078         secukinumab  Antibody      True
5        8093       tildrakizumab  Antibody      True
6        8091          reslizumab  Antibody      True
7       13084        narlumosbart  Antibody      True
8        4860          adalimumab  Antibody      True
9        8298        idarucizumab  Antibody      True
10      12969          tarlatamab  Antibody      True
11       8717          evinacumab  Antibody      True
12      12790          crovalimab  Antibody      True
13      12962         sotatercept  Antibody      True
14       9292           burosumab  Antibody      True
15       6773         canakinumab  Antibody      True
16       6774  certolizumab pegol  Antibody      True
17       6885         ustekinumab  Antibody      True
18       6887           belimumab  Antibody      True
19       9846         mirikizumab  Antibody      True
20       6886           denosumab  Antibody      True
21       6884          eculizumab  Antibody      True
22       8325          aducanumab  Antibody      True
23      10492         envafolimab  Antibody      True
24      11341           naxitamab  Antibody      True
25      12202           lecanemab  Antibody      True
26      11420           faricimab  Antibody      True
27      12342         sugemalimab  Antibody      True
28       6771         bevacizumab  Antibody      True
29       6776           golimumab  Antibody      True
30       6779         ranibizumab  Antibody      True
31       7396          siltuximab  Antibody      True
32       7541          ixekizumab  Antibody      True
33       7685         mepolizumab  Antibody      True
34       7985          durvalumab  Antibody      True
35       7990        atezolizumab  Antibody      True
36       8001        tralokinumab  Antibody      True
37       8092         romosozumab  Antibody      True
38       8713        brolucizumab  Antibody      True
39       8735            avelumab  Antibody      True
40       8922        risankizumab  Antibody      True
41       8933         tezepelumab  Antibody      True
42       8967        galcanezumab  Antibody      True
43       9123        caplacizumab  Antibody      True
44       9295          emapalumab  Antibody      True
45       9208        fremanezumab  Antibody      True
46       9411         bimekizumab  Antibody      True
47      10168         ravulizumab  Antibody      True
48      10694         eptinezumab  Antibody      True
49      11182          concizumab  Antibody      True

Generated SQL Results:
    ligand_id           name
0        5046     pertuzumab
1        5082    trastuzumab
2        6477  mogamulizumab
3        6584      abciximab
4        6591    natalizumab
..        ...            ...
90      12966    cadonilimab
91      12969     tarlatamab
92      12989    toripalimab
93      12990     sintilimab
94      13087    divozilimab

[95 rows x 2 columns]

--- Processing Test Case 40 ---
Natural Language Query: What antimalarial compounds are in the database?
Expected SQL: select ligand_id, name, gtmp_comments  from ligand where in_gtmp is true;
Generated SQL: SELECT l.ligand_id, l.name
FROM ligand l
WHERE l.ligand_id IN (
    SELECT distinct ligand_id
    FROM interaction
    WHERE object_id IN (
        SELECT object_id
        FROM object
        WHERE object_id IN (
            SELECT object_id
            FROM receptor2family
            WHERE family_id IN (
                WITH RECURSIVE subfamilies AS (
                    SELECT group_id, family_id 
                    FROM grouping 
                    WHERE group_id IN (
                        SELECT family_id 
                        FROM family 
                        WHERE name ILIKE '%Antimalarial%'
                    )
                    UNION 
                    SELECT e.group_id, e.family_id 
                    FROM grouping e
                    INNER JOIN subfamilies s ON s.family_id = e.group_id
                )
                SELECT family_id FROM subfamilies
                UNION 
                SELECT family_id 
                FROM family 
                WHERE name ILIKE '%Antimalarial%'
            )
        )
    )
    OR object_id IN (
        SELECT object_id
        FROM synonym
        WHERE synonym ILIKE '%Antimalarial%'
    )
);

Expected SQL Results:
     ligand_id                           name                                      gtmp_comments
0        11709    compound 1 [PMID: 33929818]                                                   
1        11822                   NCATS-SM3710                                                   
2        11958  compound 14a [WO2021155612A1]                                                   
3        10604   compound 2h [PMID: 30664827]                                                   
4        10614                         BCH070                                                   
..         ...                            ...                                                ...
131      10611                         GSK030  GSK030 has asexual blood stage activity, poten...
132      10616                       WEHI-842  Future progression of peptidomimetic <i>Plasmo...
133      11109                   TCMDC-135051  <b>Potential Target/Mechanism Of Action:</b> T...
134      11469                        BRD9185  <b>Potential Target/Mechanism Of Action:</b> B...
135      11704                      MMV688533  The compound was awarded <a href="https://www....

[136 rows x 3 columns]

Generated SQL Results:
    ligand_id                           name
0       11709    compound 1 [PMID: 33929818]
1       11822                   NCATS-SM3710
2       11958  compound 14a [WO2021155612A1]
3       10604   compound 2h [PMID: 30664827]
4       10320                          Lys01
..        ...                            ...
73      10153                   halofuginone
74      10611                         GSK030
75      10616                       WEHI-842
76      11109                   TCMDC-135051
77      11469                        BRD9185

[78 rows x 2 columns]

--- Processing Test Case 41 ---
Natural Language Query: What are the selective antagonists for Leukotriene receptors and their affinities?
Expected SQL: select o.object_id, o.name as name, i.ligand_id, l.name, i.affinity_units,i.type,i.selective,case when i.affinity_median is null then case when i.affinity_high is null then i.affinity_low else i.affinity_high end else i.affinity_median end as affinity from object o, interaction i, ligand l where o.object_id in (select object_id from receptor2family where family_id in ((WITH RECURSIVE subfamilies AS ( SELECT group_id, family_id from grouping where group_id in (select family_id from family where name ilike '%Leukotriene receptors%') UNION SELECT e.group_id, e.family_id from grouping e INNER JOIN subfamilies s ON s.family_id=e.group_id) SELECT family_id FROM subfamilies order by family_id) union select family_id from family where family_id in (select family_id from family where name ilike '%Leukotriene receptors%'))) and o.object_id=i.object_id and ((i.affinity_units is not null and i.affinity_units != '-' and i.affinity_units != '') or (i.concentration_range is not null and i.concentration_range != '-' and i.concentration_range != '')) and i.ligand_id=l.ligand_id and i.type='Antagonist' and i.selectivity='Selective';
Generated SQL: WITH RECURSIVE subfamilies AS (
    SELECT group_id, family_id 
    FROM grouping 
    WHERE group_id IN (SELECT family_id FROM family WHERE name ILIKE '%Leukotriene receptors%') 
    UNION 
    SELECT e.group_id, e.family_id 
    FROM grouping e 
    INNER JOIN subfamilies s ON s.family_id = e.group_id
)
SELECT l.ligand_id, l.name, o.object_id, o.name, i.affinity_units, 
       CASE 
           WHEN i.affinity_median IS NULL THEN 
               CASE 
                   WHEN i.affinity_high IS NULL THEN i.affinity_low 
                   ELSE i.affinity_high 
               END 
           ELSE i.affinity_median 
       END AS affinity
FROM interaction i
JOIN ligand l ON i.ligand_id = l.ligand_id
JOIN object o ON i.object_id = o.object_id
WHERE i.object_id IN (
    SELECT object_id 
    FROM receptor2family 
    WHERE family_id IN (
        SELECT family_id 
        FROM subfamilies 
        UNION 
        SELECT family_id FROM family WHERE family_id IN (
            SELECT family_id FROM family WHERE name ILIKE '%Leukotriene receptors%'
        )
    )
) 
AND i.type = 'Antagonist'
AND i.selective IS TRUE;

Expected SQL Results:
    object_id                        name  ligand_id  ...        type selective affinity
0         269  CysLT<sub>1</sub> receptor       3358  ...  Antagonist     False     9.70
1         269  CysLT<sub>1</sub> receptor       3340  ...  Antagonist     False     8.55
2         270  CysLT<sub>2</sub> receptor       6196  ...  Antagonist      True     8.30
3         270  CysLT<sub>2</sub> receptor       6197  ...  Antagonist     False     7.42
4         270  CysLT<sub>2</sub> receptor       6196  ...  Antagonist      True     8.40
5         269  CysLT<sub>1</sub> receptor       6193  ...  Antagonist      True     8.10
6         223                        FPR2       1030  ...  Antagonist      True     6.00
7         269  CysLT<sub>1</sub> receptor       6193  ...  Antagonist     False     7.97
8         269  CysLT<sub>1</sub> receptor      10346  ...  Antagonist     False     8.00
9         269  CysLT<sub>1</sub> receptor      10581  ...  Antagonist      True     9.00
10        269  CysLT<sub>1</sub> receptor       3322  ...  Antagonist      True     8.90
11        269  CysLT<sub>1</sub> receptor       3329  ...  Antagonist     False     8.70
12        223                        FPR2       1040  ...  Antagonist      True     6.64
13        269  CysLT<sub>1</sub> receptor       3322  ...  Antagonist      True     8.74
14        269  CysLT<sub>1</sub> receptor       3327  ...  Antagonist     False     8.30
15        267    BLT<sub>1</sub> receptor       3325  ...  Antagonist     False     6.40
16        267    BLT<sub>1</sub> receptor       3368  ...  Antagonist     False     8.10
17        271                OXE receptor       6171  ...  Antagonist     False     6.30
18        267    BLT<sub>1</sub> receptor       6154  ...  Antagonist     False     8.80
19        270  CysLT<sub>2</sub> receptor       6196  ...  Antagonist      True     7.28
20        268    BLT<sub>2</sub> receptor       3351  ...  Antagonist      True     7.10
21        269  CysLT<sub>1</sub> receptor       3340  ...  Antagonist     False     8.64

[22 rows x 8 columns]

Generated SQL Results:
    ligand_id                                  name  ...  affinity_units affinity
0        3634                            pranlukast  ...           pIC50     5.44
1        3322                           zafirlukast  ...             pA2     6.90
2        3322                           zafirlukast  ...           pIC50     5.15
3        5861                             iralukast  ...             pKi     7.80
4        3334                            pobilukast  ...             pKi     7.10
5        3634                            pranlukast  ...           pIC50     8.37
6        3634                            pranlukast  ...             pKi     8.80
7        3634                            pranlukast  ...           pIC50    10.00
8        3334                            pobilukast  ...           pIC50     8.26
9        3414             [<sup>3</sup>H]ICI-198615  ...             pKd    10.60
10       6196                  BayCysLT<sub>2</sub>  ...             pA2     8.30
11       6196                  BayCysLT<sub>2</sub>  ...             pA2     8.40
12       3322                           zafirlukast  ...           pIC50     7.70
13       3322                           zafirlukast  ...           pIC50     9.59
14       6193                             verlukast  ...           pIC50     8.10
15       1030                           t-Boc-FLFLF  ...           pIC50     6.00
16       5861                             iralukast  ...             pA2     6.80
17       3334                            pobilukast  ...             pA2     6.20
18       3634                            pranlukast  ...             pA2     7.10
19      10002  triple modulator 10 [PMID: 29878767]  ...             pA2     8.70
20      10581         compound 13e [PMID: 31811124]  ...           pIC50     9.00
21       3322                           zafirlukast  ...           pIC50     5.13
22       3322                           zafirlukast  ...             pKi     8.90
23       3334                            pobilukast  ...           pIC50     7.52
24       1040                                WRWWWW  ...           pIC50     6.64
25       3322                           zafirlukast  ...           pIC50     8.74
26       6196                  BayCysLT<sub>2</sub>  ...           pIC50     7.28
27       3351                              LY255283  ...           pIC50     7.10

[28 rows x 6 columns]

--- Processing Test Case 42 ---
Natural Language Query: What is known about Opioid delta receptor agonists?
Expected SQL: select l.ligand_id, l.name, l.type, o.object_id, o.name, i.type, i.action, i.affinity_units from interaction i, ligand l, object o where i.object_id in (select object_id from object where object_id in (select object_id from receptor2family where family_id in ((WITH RECURSIVE subfamilies AS ( SELECT group_id, family_id from grouping where group_id in (select family_id from family where name ilike '%opioid receptor%') UNION SELECT e.group_id, e.family_id from grouping e INNER JOIN subfamilies s ON s.family_id=e.group_id) SELECT family_id FROM subfamilies order by family_id) union select family_id from family where family_id in (select family_id from family where name ilike '%opioid receptor%')))) and i.type='Agonist' and i.ligand_id=l.ligand_id and i.object_id=o.object_id and o.name ilike '%delta%';
Generated SQL: SELECT l.ligand_id, l.name, l.type, l.comments, l.bioactivity_comments, l.mechanism_of_action,
       i.type, i.action, i.object_id, i.affinity_high, i.affinity_median, i.affinity_low, i.affinity_units
FROM ligand l
LEFT JOIN interaction i ON l.ligand_id = i.ligand_id
WHERE i.type = 'Agonist' 
  AND i.object_id IN (
    SELECT object_id 
    FROM object 
    WHERE object_id IN (
      SELECT object_id 
      FROM receptor2family 
      WHERE family_id IN (
        WITH RECURSIVE subfamilies AS (
          SELECT group_id, family_id 
          FROM grouping 
          WHERE group_id IN (
            SELECT family_id 
            FROM family 
            WHERE name ILIKE '%Opioid delta receptor%'
          )
          UNION
          SELECT e.group_id, e.family_id 
          FROM grouping e 
          INNER JOIN subfamilies s ON s.family_id = e.group_id
        )
        SELECT family_id 
        FROM subfamilies
        UNION
        SELECT family_id 
        FROM family 
        WHERE family_id IN (
          SELECT family_id 
          FROM family 
          WHERE name ILIKE '%Opioid delta receptor%'
        )
      )
    )
  );

Expected SQL Results:
    ligand_id                          name  ...           action  affinity_units
0        1625                     etorphine  ...     Full agonist             pKi
1        1607                         DADLE  ...     Full agonist             pKi
2        1612  [<sup>3</sup>H]diprenorphine  ...     Full agonist             pKi
3        1618              dynorphin-(1-11)  ...     Full agonist             pKi
4        1615                 deltorphin II  ...     Full agonist             pKi
..        ...                           ...  ...              ...             ...
60       9005                   AR-M1000390  ...          Agonist           pIC50
61       9006                       UFP-512  ...          Agonist             pKi
62       9294                       BU08028  ...  Partial agonist             pKi
63       8866                  cebranopadol  ...          Agonist             pKi
64      13395                     atoxifent  ...          Agonist           pEC50

[65 rows x 8 columns]

Generated SQL Results:
Empty DataFrame
Columns: [ligand_id, name, type, comments, bioactivity_comments, mechanism_of_action, type, action, object_id, affinity_high, affinity_median, affinity_low, affinity_units]
Index: []

--- Processing Test Case 43 ---
Natural Language Query: What compounds have a role in treating arthritis?
Expected SQL: select idl.ligand_id, l.name, idl.comment, d.name from immuno_disease2ligand idl, ligand l, disease d where idl.disease_id in (select disease_id from disease where name ilike '%arthritis%' union select disease_id from disease2synonym where synonym ilike '%arthritis%') and idl.ligand_id=l.ligand_id and d.disease_id=idl.disease_id;
Generated SQL: SELECT idl.ligand_id, l.name, idl.comment, d.name 
FROM immuno_disease2ligand idl
JOIN ligand l ON idl.ligand_id = l.ligand_id
JOIN disease d ON idl.disease_id = d.disease_id
WHERE idl.disease_id IN (
    SELECT disease_id FROM disease WHERE name ILIKE '%arthritis%'
    UNION 
    SELECT disease_id FROM disease2synonym WHERE synonym ILIKE '%arthritis%'
);

Expected SQL Results:
     ligand_id          name                                            comment                  name
0          422  piclidenoson   Clinical candidate for RA (Phase 2 NCT01034306).  Rheumatoid arthritis
1          422  piclidenoson  Clinical candidate for OA of the knee (Phase 2...        Osteoarthritis
2         4820    fenoprofen  Approved NSAID used for many inflammatory cond...        Osteoarthritis
3         4860    adalimumab  Anti-TNF&alpha; monoclonal antibody therapy ap...  Rheumatoid arthritis
4         5668   doramapimod                 Phase 2 clinical candidate for RA.  Rheumatoid arthritis
..         ...           ...                                                ...                   ...
174      10370     namilumab  Phase 2 clinical candidate for RA: namilumab h...  Rheumatoid arthritis
175       4998          IL-6  IL-6 is known to drive arthritic inflammation ...  Rheumatoid arthritis
176      10464  elsubrutinib                          Clinical candidate for RA  Rheumatoid arthritis
177       9559  ritlecitinib  Phase 2 clinical candidate for RA (NCT02969044...  Rheumatoid arthritis
178      12917     ABBV-3373                   Investugational treatment for RA  Rheumatoid arthritis

[179 rows x 4 columns]

Generated SQL Results:
     ligand_id          name                                            comment                  name
0          422  piclidenoson   Clinical candidate for RA (Phase 2 NCT01034306).  Rheumatoid arthritis
1          422  piclidenoson  Clinical candidate for OA of the knee (Phase 2...        Osteoarthritis
2         4820    fenoprofen  Approved NSAID used for many inflammatory cond...        Osteoarthritis
3         4860    adalimumab  Anti-TNF&alpha; monoclonal antibody therapy ap...  Rheumatoid arthritis
4         5668   doramapimod                 Phase 2 clinical candidate for RA.  Rheumatoid arthritis
..         ...           ...                                                ...                   ...
174      10370     namilumab  Phase 2 clinical candidate for RA: namilumab h...  Rheumatoid arthritis
175       4998          IL-6  IL-6 is known to drive arthritic inflammation ...  Rheumatoid arthritis
176      10464  elsubrutinib                          Clinical candidate for RA  Rheumatoid arthritis
177       9559  ritlecitinib  Phase 2 clinical candidate for RA (NCT02969044...  Rheumatoid arthritis
178      12917     ABBV-3373                   Investugational treatment for RA  Rheumatoid arthritis

[179 rows x 4 columns]

--- Processing Test Case 44 ---
Natural Language Query: Find all the papers in the Guide that are listed as preprints (useful for housekeeping)
Expected SQL: select * from reference where pub_status ilike '%preprint%' or pub_status ilike '%pre-print%';
Generated SQL: SELECT reference_id, type, title, article_title, year, issue, volume, pages, publisher, publisher_address, editors, pubmed_id, isbn, pub_status, topics, comments, read, useful, website, url, doi, accessed, modified, patent_number, priority, publication, authors, assignee, pmc_id
FROM reference
WHERE pub_status ILIKE '%preprint%';

Expected SQL Results:
    reference_id  ...                               article_title_vector
0          41957  ...  'class':6 'coronavirus':15 'design':2 'diseas'...
1          42064  ...  '2':12 'block':8 'cell':24 'class':3 'cov':11,...
2          42139  ...  '2':5 'associ':7 'b.1.617':12 'cleavag':16 'co...
3          42140  ...        'complet':2 'genom':7 'human':6 'sequenc':3
4          42305  ...  'design':8 'drug':7 'fashion':3 'hype':5 'rati...
..           ...  ...                                                ...
60         46152  ...  'analysi':5 'associ':4 'cardiomyopathi':14 'di...
61         46304  ...  'activ':3 'amelior':4 'diseas':9 'model':10 'p...
62         47293  ...  '2':6 'cov':5 'discoveri':1 'efficaci':14 'inf...
63         47301  ...  'class':7 'degrad':10 'discoveri':1 'first':5 ...
64         47330  ...  'cancer':15 'control':7 'g12c':6 'growth':9 'i...

[65 rows x 31 columns]

Generated SQL Results:
    reference_id     type  ... assignee pmc_id
0          41957  Journal  ...     None   None
1          42064  Journal  ...     None   None
2          42139  Journal  ...     None   None
3          42140  Journal  ...     None   None
4          42305  Journal  ...     None   None
..           ...      ...  ...      ...    ...
59         46152  Journal  ...     None   None
60         46304  Journal  ...     None   None
61         47293  Journal  ...     None   None
62         47301  Journal  ...     None   None
63         47330  Journal  ...     None   None

[64 rows x 29 columns]

--- Processing Test Case 45 ---
Natural Language Query: Are there compounds which can block all adenosine, muscarinic, LPA, cannabinoid or dopamine receptors? Originally: Are there compounds which can block all adenosine (muscarinic, LPA, cannabinoid, dopamine) receptors?  
Expected SQL: select i.ligand_id, l.name, count(distinct i.object_id) as targets, f.name from interaction i, ligand l, family f, receptor2family r2f where i.object_id in (select object_id from receptor2family where family_id in((WITH RECURSIVE subfamilies AS ( SELECT group_id, family_id from grouping where group_id in (select family_id from family where (name ilike '%Adenosine receptors%' OR name ilike '%Acetylcholine receptors \(muscarinic\)%' OR name ilike '%Cannabinoid receptors%' OR name ilike '%Dopamine receptors%' or name ilike '%Lysophospholipid (LPA) receptors%')) UNION SELECT e.group_id, e.family_id from grouping e INNER JOIN subfamilies s ON s.family_id=e.group_id) SELECT family_id FROM subfamilies order by family_id) union select family_id from family where family_id in (select family_id from family where (name ilike '%Adenosine receptors%' OR name ilike '%Acetylcholine receptors \(muscarinic\)%' OR name ilike '%Cannabinoid receptors%' OR name ilike '%Dopamine receptors%' or name ilike '%Lysophospholipid (LPA) receptors%')))) and i.type in ('Channel blocker','Gating inhibitor','Inhibitor','Antagonist') and i.ligand_id=l.ligand_id and i.object_id=r2f.object_id and r2f.family_id=f.family_id group by i.ligand_id, l.name, f.name, f.family_id having count(distinct i.object_id) = (select count(distinct object_id) from object where object_id in (select object_id from receptor2family where family_id in((WITH RECURSIVE subfamilies AS ( SELECT group_id, family_id from grouping where group_id in (f.family_id) UNION SELECT e.group_id, e.family_id from grouping e INNER JOIN subfamilies s ON s.family_id=e.group_id) SELECT family_id FROM subfamilies order by family_id) union select family_id from family where family_id in (f.family_id)))) order by f.name,l.name;
Generated SQL: WITH RECURSIVE receptor_families AS (
    SELECT group_id, family_id FROM grouping WHERE group_id IN (
        SELECT family_id FROM family WHERE name ILIKE '%adenosine%' 
        UNION 
        SELECT family_id FROM family WHERE name ILIKE '%muscarinic%' 
        UNION 
        SELECT family_id FROM family WHERE name ILIKE '%LPA%' 
        UNION 
        SELECT family_id FROM family WHERE name ILIKE '%cannabinoid%' 
        UNION 
        SELECT family_id FROM family WHERE name ILIKE '%dopamine%'
    )
    UNION
    SELECT e.group_id, e.family_id FROM grouping e
    INNER JOIN receptor_families r ON r.family_id = e.group_id
)
SELECT i.ligand_id, l.name
FROM interaction i
JOIN ligand l ON i.ligand_id = l.ligand_id
WHERE i.object_id IN (
    SELECT object_id FROM receptor2family
    WHERE family_id IN (
        SELECT family_id FROM receptor_families
        UNION 
        SELECT family_id FROM family WHERE name ILIKE '%adenosine%' 
        UNION 
        SELECT family_id FROM family WHERE name ILIKE '%muscarinic%' 
        UNION 
        SELECT family_id FROM family WHERE name ILIKE '%LPA%' 
        UNION 
        SELECT family_id FROM family WHERE name ILIKE '%cannabinoid%' 
        UNION 
        SELECT family_id FROM family WHERE name ILIKE '%dopamine%'
    )
)
AND i.type = 'Antagonist'
GROUP BY i.ligand_id, l.name
HAVING COUNT(DISTINCT i.object_id) = (
    SELECT COUNT(DISTINCT family_id) FROM receptor_families
)
ORDER BY l.name;

Expected SQL Results:
    ligand_id                                 name  targets                                  name
0       10104                      (S)-dimetindene        5  Acetylcholine receptors (muscarinic)
1         317  [<sup>3</sup>H]N-methyl scopolamine        5  Acetylcholine receptors (muscarinic)
2         318                   [<sup>3</sup>H]QNB        5  Acetylcholine receptors (muscarinic)
3         308                     <i>p</i>-F-HHSiD        5  Acetylcholine receptors (muscarinic)
4         307                               4-DAMP        5  Acetylcholine receptors (muscarinic)
..        ...                                  ...      ...                                   ...
72         62                       (+)-butaclamol        5                    Dopamine receptors
73         83                       chlorpromazine        5                    Dopamine receptors
74         38                            clozapine        5                    Dopamine receptors
75         86                          haloperidol        5                    Dopamine receptors
76         99                            spiperone        5                    Dopamine receptors

[77 rows x 4 columns]

Generated SQL Results:
    ligand_id                                     name
0         955                              (+)-S-14297
1         957                                (+)-UH232
2         945                [<sup>125</sup>I]SCH23982
3         196  [<sup>3</sup>H]<i>N</i>-methylspiperone
4         368                 [<sup>3</sup>H]AF DX-384
..        ...                                      ...
61        214                          trifluoperazine
62        433                                 visnagin
63       2909                                 VPC12249
64       5450                                 VPC32179
65       2908                                 VPC32183

[66 rows x 2 columns]

--- Processing Test Case 46 ---
Natural Language Query: What should I use to inhibit TRPM3 in cultured cells, and at what concentration?  
Expected SQL: select l.ligand_id, l.name, case when i.affinity_median is null then case when i.affinity_high is null then i.affinity_low else i.affinity_high end else i.affinity_median end as affinity, i.affinity_units, i.type, i.action from ligand l, interaction i where i.object_id in (select object_id from object where object_id in (select object_id from receptor2family where family_id in (select family_id from family where name ilike '%TRPM3%')) union select object_id from object where name ilike '%TRPM3%') and l.ligand_id=i.ligand_id and i.type in ('Channel blocker','Gating inhibitor','Inhibitor','Antagonist') and ((i.affinity_units is not null and i.affinity_units != '-' and i.affinity_units != '') or (i.concentration_range is not null and i.concentration_range != '-' and i.concentration_range != ''));
Generated SQL: SELECT 
    l.ligand_id, 
    l.name, 
    i.affinity_units, 
    CASE 
        WHEN i.affinity_median IS NULL THEN 
            CASE 
                WHEN i.affinity_high IS NULL THEN i.affinity_low 
                ELSE i.affinity_high 
            END 
        ELSE i.affinity_median 
    END AS affinity
FROM 
    interaction i
JOIN 
    ligand l ON i.ligand_id = l.ligand_id
WHERE 
    i.object_id IN (
        SELECT object_id 
        FROM object 
        WHERE name ILIKE '%TRPM3%' OR abbreviation ILIKE '%TRPM3%'
    ) 
    AND i.type = 'Inhibitor' 
    AND ((i.affinity_units IS NOT NULL AND i.affinity_units != '-') 
    OR (i.concentration_range IS NOT NULL AND i.concentration_range != '-' AND i.concentration_range != ''))
ORDER BY affinity DESC;

Expected SQL Results:
    ligand_id                       name  affinity affinity_units              type      action
0        2714                 diclofenac      5.20          pIC50   Channel blocker        None
1        2402                maprotiline      5.80          pIC50   Channel blocker        None
2        5338                  primidone      6.20          pIC50   Channel blocker        None
3        8899  (<i>S</i>)-liquiritigenin      5.20          pIC50   Channel blocker        None
4       10298                 naringenin      5.20          pIC50   Channel blocker        None
5         708            Mg<sup>2+</sup>      2.00          pIC50   Channel blocker  Antagonist
6        2433                      2-APB      4.00          pIC50  Gating inhibitor  Antagonist
7        2426            Gd<sup>3+</sup>      4.00          pIC50   Channel blocker  Antagonist
8        2434            La<sup>3+</sup>      4.00          pIC50   Channel blocker  Antagonist
9        2401                  halothane      3.28          pIC50   Channel blocker  Antagonist
10       2503                 chloroform      3.78          pIC50   Channel blocker  Antagonist
11      10299             isosakuranetin      7.30          pIC50   Channel blocker        None

Generated SQL Results:
Empty DataFrame
Columns: [ligand_id, name, affinity_units, affinity]
Index: []

--- Processing Test Case 47 ---
Natural Language Query: Find SMILES and InChiKey for alitretinoin
Expected SQL: select ls.isomeric_smiles, ls.isomeric_standard_inchi_key from ligand_structure ls, ligand l where ls.ligand_id = l.ligand_id and l.name = 'alitretinoin';
Generated SQL: SELECT l.ligand_id, l.name, ls.isomeric_smiles, ls.isomeric_standard_inchi_key
FROM ligand l
JOIN ligand_structure ls ON l.ligand_id = ls.ligand_id
WHERE l.name ILIKE '%alitretinoin%';

Expected SQL Results:
                                   isomeric_smiles  isomeric_standard_inchi_key
0  C/C(=C/C=C/C(=C/C(=O)O)/C)/C=C/C1=C(C)CCCC1(C)C  SHGAZHPCJJPHSC-ZVCIMWCZSA-N

Generated SQL Results:
   ligand_id  ...  isomeric_standard_inchi_key
0       2645  ...  SHGAZHPCJJPHSC-ZVCIMWCZSA-N

[1 rows x 4 columns]

--- Processing Test Case 48 ---
Natural Language Query: Is there recommended background reading on endothelin receptors?
Expected SQL: select r.reference_id, r.title, r.article_title, r.year, r.pubmed_id, fr.key_ref from reference r, grac_further_reading fr where r.reference_id=fr.reference_id and fr.family_id in ((WITH RECURSIVE subfamilies AS ( SELECT group_id, family_id from grouping where group_id in (select family_id from family where name ilike '%endothelin receptors%') UNION SELECT e.group_id, e.family_id from grouping e INNER JOIN subfamilies s ON s.family_id=e.group_id) SELECT family_id FROM subfamilies order by family_id) union select family_id from family where family_id in (select family_id from family where name ilike '%endothelin receptors%'));
Generated SQL: SELECT f.family_id, f.name, g.overview, g.comments, i.text 
FROM family f 
LEFT JOIN grac_family_text g ON g.family_id=f.family_id 
LEFT JOIN introduction i ON i.family_id=f.family_id 
WHERE f.name ILIKE '%endothelin%';

Expected SQL Results:
    reference_id                                   title  ... pubmed_id  key_ref
0          43561                      J Mol Cell Cardiol  ...  35339512    False
1          13988                 Int J Biochem Cell Biol  ...  18325824    False
2          28243                     Handb Exp Pharmacol  ...  24092342     True
3          21893                                Life Sci  ...  22884806    False
4          21894                                Life Sci  ...  22846215    False
5           3083                           Pharmacol Rev  ...  12037137     True
6          36073                             Physiol Res  ...  29947527     True
7          14942                           Pflugers Arch  ...  19967386    False
8          21895                            Hypertension  ...  23608655    False
9          28246                           Semin Nephrol  ...  25966344    False
10         28244                                Life Sci  ...  22967485    False
11          3096              Annu Rev Pharmacol Toxicol  ...  17002597    False
12         21890                           Pharmacol Res  ...  21352917    False
13         14940                             Physiol Rev  ...  21248162    False
14         21891                          Br J Pharmacol  ...  22670597    False
15         21892                          Br J Pharmacol  ...  22118774    False
16         14941  Am J Physiol Regul Integr Comp Physiol  ...  20237301    False
17         13995                   Trends Cardiovasc Med  ...  19232951    False
18         28245                          Br J Pharmacol  ...  25131455     True
19         32140                           Pharmacol Rev  ...  26956245     True
20         45083                         Nat Rev Cardiol  ...  30867577     True
21         45084                            Reproduction  ...  35167488     True
22         45085                   J Exp Clin Cancer Res  ...  33422090     True

[23 rows x 6 columns]

Generated SQL Results:
   family_id  ...                                               text
0         21  ...  <heading>General</heading><p>In mammals, the e...

[1 rows x 5 columns]

--- Processing Test Case 49 ---
Natural Language Query: Find apelin ligands that are radiolabelled together with their pKDs.
Expected SQL: select l.ligand_id, l.name, l.radioactive, case when i.affinity_median is null then case when i.affinity_high is null then i.affinity_low else i.affinity_high end else i.affinity_median end as affinity, i.affinity_units from ligand l, interaction i where i.object_id in (select object_id from object where object_id in (select object_id from receptor2family where family_id in (select family_id from family where name ilike '%apelin%')) union select object_id from object where name ilike '%apelin%') and l.ligand_id=i.ligand_id and l.radioactive is true;
Generated SQL: SELECT 
    l.ligand_id, 
    l.name, 
    l.radioactive, 
    i.affinity_units, 
    CASE 
        WHEN i.affinity_median IS NULL THEN 
            CASE 
                WHEN i.affinity_high IS NULL THEN i.affinity_low 
                ELSE i.affinity_high 
            END 
        ELSE i.affinity_median 
    END AS affinity
FROM 
    ligand l
JOIN 
    interaction i ON l.ligand_id = i.ligand_id
WHERE 
    l.radioactive = true 
    AND i.affinity_units = 'pKD'
    AND i.object_id IN (
        SELECT object_id 
        FROM object 
        WHERE name ILIKE '%apelin%'
    );

Expected SQL Results:
   ligand_id                                               name  radioactive  affinity affinity_units
0        601        [<sup>125</sup>I](Pyr<sup>1</sup>)apelin-13         True       9.5            pKd
1        604  [<sup>3</sup>H](Pyr<sup>1</sup>)[Met(0)11]-ape...         True       8.6            pKd
2        602                         [<sup>125</sup>I]apelin-13         True       9.2            pKd
3       3761  [<sup>125</sup>I][Glp<sup>65</sup>Nle<sup>75</...         True      10.7            pKd
4        603  [<sup>125</sup>I][Nle<sup>75</sup>,Tyr<sup>77<...         True      11.2            pKd

Generated SQL Results:
Empty DataFrame
Columns: [ligand_id, name, radioactive, affinity_units, affinity]
Index: []

--- Processing Test Case 50 ---
Natural Language Query: Find natural products ligands, that meet lipinski rule-of-5 and have SMILES
Expected SQL: select l.ligand_id, l.name, l.type, ls.isomeric_smiles from ligand l, ligand_physchem lp, ligand_structure ls where l.ligand_id=lp.ligand_id and lp.lipinski_s_rule_of_five = 0 and l.type = 'Natural product' and l.ligand_id=ls.ligand_id;
Generated SQL: SELECT l.ligand_id, l.name, lp.molecular_weight, lp.hydrogen_bond_acceptors, lp.hydrogen_bond_donors, lp.rotatable_bonds_count, lp.xlogp, ls.isomeric_smiles
FROM ligand l
JOIN ligand_physchem lp ON l.ligand_id = lp.ligand_id
JOIN ligand_structure ls ON l.ligand_id = ls.ligand_id
WHERE l.type = 'Natural product'
AND lp.molecular_weight <= 500
AND lp.hydrogen_bond_acceptors <= 10
AND lp.hydrogen_bond_donors <= 5
AND lp.rotatable_bonds_count <= 10
AND lp.xlogp <= 5;

Expected SQL Results:
     ligand_id  ...                                    isomeric_smiles
0        12130  ...  Cc1ccc([nH]1)C(=O)O[C@H]1[C@H]([C@@H](OC([C@@H...
1        12129  ...  Cc1ccc([nH]1)C(=O)O[C@@H]1[C@@H]([C@H](C(O[C@H...
2        12128  ...  Cc1ccc([nH]1)C(=O)O[C@H]1[C@H]([C@@H](OC([C@@H...
3        12021  ...  Cc1c(ccc2c1oc(=O)c(c2O)NC(=O)c1cc(c(cc1)O)CC=C...
4        11377  ...               COc1c(O)cc(c2c1n(C)c1c(c2=O)cccc1O)O
..         ...  ...                                                ...
216      13283  ...                             CC1=C(C(CC=C1)(C)C)C=O
217      13327  ...  COC1=C(C(=C(C(=C1)O)CC2=CC=CC=C2O)O)C(=O)CCC3=...
218      13363  ...  C=C[C@H]1CN2CC[C@H]1C[C@@H]2[C@H](C3=CC=NC4=CC...
219      13376  ...         COC1=CC(=CC(=C1OC)OC)/C=C/C(=O)N2CCC=CC2=O
220      13407  ...     CCCCCC1=CC(O)=C(C/C=C(\C)/CCC(O)C(C)=C)C(O)=C1

[221 rows x 4 columns]

Generated SQL Results:
     ligand_id  ...                                    isomeric_smiles
0        11377  ...               COc1c(O)cc(c2c1n(C)c1c(c2=O)cccc1O)O
1        11372  ...  C1Oc2c(O1)cc(cc2)[C@H]1OC[C@H]2[C@@H]1CO[C@@H]...
2        11353  ...       COc1c(OC)ccc2c1c[n+]1CCc3c(c1c2)cc1c(c3)OCO1
3        11306  ...  N#C/C/1=C/C=C/C[C@H](OC(=O)C[C@@H]([C@H](C[C@H...
4        11291  ...                         CN(CCc1c[nH]c2c1c(O)ccc2)C
..         ...  ...                                                ...
196      13283  ...                             CC1=C(C(CC=C1)(C)C)C=O
197      13327  ...  COC1=C(C(=C(C(=C1)O)CC2=CC=CC=C2O)O)C(=O)CCC3=...
198      13363  ...  C=C[C@H]1CN2CC[C@H]1C[C@@H]2[C@H](C3=CC=NC4=CC...
199      13376  ...         COC1=CC(=CC(=C1OC)OC)/C=C/C(=O)N2CCC=CC2=O
200      13407  ...     CCCCCC1=CC(O)=C(C/C=C(\C)/CCC(O)C(C)=C)C(O)=C1

[201 rows x 8 columns]

--- Processing Test Case 51 ---
Natural Language Query: What are the affinity values for SLC29 family inhibitors?
Expected SQL: select o.object_id, o.name as name, i.ligand_id, l.name, i.affinity_units, case when i.affinity_median is null then case when i.affinity_high is null then i.affinity_low else i.affinity_high end else i.affinity_median end as affinity from object o, interaction i, ligand l where o.object_id in (select object_id from receptor2family where family_id in ((WITH RECURSIVE subfamilies AS ( SELECT group_id, family_id from grouping where group_id in (select family_id from family where name ilike '%SLC29 family%') UNION SELECT e.group_id, e.family_id from grouping e INNER JOIN subfamilies s ON s.family_id=e.group_id) SELECT family_id FROM subfamilies order by family_id) union select family_id from family where family_id in (select family_id from family where name ilike '%SLC29 family%'))) and o.object_id=i.object_id and ((i.affinity_units is not null and i.affinity_units != '-' and i.affinity_units != '') or (i.concentration_range is not null and i.concentration_range != '-' and i.concentration_range != '')) and i.ligand_id=l.ligand_id;
Generated SQL: WITH RECURSIVE subfamilies AS (
    SELECT group_id, family_id 
    FROM grouping 
    WHERE group_id IN (SELECT family_id FROM family WHERE name ILIKE '%SLC29%')
    UNION 
    SELECT e.group_id, e.family_id 
    FROM grouping e
    INNER JOIN subfamilies s ON s.family_id = e.group_id
)
SELECT i.ligand_id, l.name, i.object_id, o.name AS target_name, i.affinity_units, 
       CASE 
           WHEN i.affinity_median IS NULL THEN 
               CASE 
                   WHEN i.affinity_high IS NULL THEN i.affinity_low 
                   ELSE i.affinity_high 
               END 
           ELSE i.affinity_median 
       END AS affinity
FROM interaction i
JOIN ligand l ON i.ligand_id = l.ligand_id
JOIN object o ON i.object_id = o.object_id
WHERE i.object_id IN (
    SELECT object_id 
    FROM receptor2family 
    WHERE family_id IN (
        SELECT family_id FROM subfamilies 
        UNION 
        SELECT family_id FROM family WHERE name ILIKE '%SLC29%'
    )
)
AND i.type = 'Inhibitor';

Expected SQL Results:
    object_id                                    name  ...  affinity_units affinity
0        1120   Plasma membrane monoamine transporter  ...             pKi     5.90
1        1120   Plasma membrane monoamine transporter  ...             pKi     4.64
2        1120   Plasma membrane monoamine transporter  ...             pKi     4.49
3        1120   Plasma membrane monoamine transporter  ...             pKi     7.00
4        1117  Equilibrative nucleoside transporter 1  ...             pKi     7.30
5        1117  Equilibrative nucleoside transporter 1  ...             pKd     9.30
6        1120   Plasma membrane monoamine transporter  ...             pKi     3.30
7        1120   Plasma membrane monoamine transporter  ...             pKi     4.73
8        1120   Plasma membrane monoamine transporter  ...             pKi     4.60
9        1120   Plasma membrane monoamine transporter  ...             pKi     4.57
10       1120   Plasma membrane monoamine transporter  ...             pKi     5.99
11       1117  Equilibrative nucleoside transporter 1  ...             pKi     9.40
12       1117  Equilibrative nucleoside transporter 1  ...             pKi     9.00
13       1117  Equilibrative nucleoside transporter 1  ...             pKi     8.80
14       1117  Equilibrative nucleoside transporter 1  ...             pKi     9.60
15       1117  Equilibrative nucleoside transporter 1  ...             pKi     9.30
16       1117  Equilibrative nucleoside transporter 1  ...             pKi     9.70

[17 rows x 6 columns]

Generated SQL Results:
    ligand_id                                      name  ...  affinity_units affinity
0        4807                              dipyridamole  ...             pKi     5.90
1        8485              compound 48 [PMID: 25815140]  ...           pIC50     6.19
2         203                                fluoxetine  ...             pKi     4.64
3        2399                               desipramine  ...             pKi     4.49
4        8482                               decynium 22  ...             pKi     7.00
5        8837              compound 16 [PMID: 19097778]  ...             pKi     5.54
6        1765                                ticagrelor  ...             pKi     7.30
7        1231                                cimetidine  ...             pKi     3.30
8        2406                                 verapamil  ...             pKi     4.73
9        2342                                 quinidine  ...             pKi     4.60
10       2510                                   quinine  ...             pKi     4.57
11       4607                              rhodamine123  ...             pKi     5.99
12       4734                                   KF24345  ...             pKi     9.40
13       4717                                   dilazep  ...             pKi     9.00
14       4807                              dipyridamole  ...             pKi     8.80
15       4590                                draflazine  ...             pKi     9.60
16       4513                                    NBTGR   ...             pKi     9.30
17       4512  nitrobenzylmercaptopurine ribonucleoside  ...             pKi     9.70

[18 rows x 6 columns]
==================================================
Total test queries executed: 13
Successful test queries: 10
None count: 0
None IDs: 
Empty count: 3
Empty IDs: 18, 26, 11
==================================================
